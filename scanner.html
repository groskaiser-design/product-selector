<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<title>Smart Diary</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  /* === CORE & SCROLLBARS === */
  *::-webkit-scrollbar { display: none; }
  * { -ms-overflow-style: none; scrollbar-width: none; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
  
  :root {
    --bg-core: #050505;
    --text-main: #ffffff;
    --text-muted: rgba(255, 255, 255, 0.55);
    --surface-glass: rgba(255, 255, 255, 0.08);
    --surface-border: rgba(255, 255, 255, 0.12);
    --surface-active: rgba(255, 255, 255, 0.15);
    
    --acc-orange: #ff9f0a;
    --acc-green: #30d158;
    --acc-blue: #0a84ff;
    --acc-red: #ff453a;
    
    --radius-xl: 24px;
    --radius-m: 16px;
    --radius-s: 12px;
    
    --safe-bottom: calc(90px + env(safe-area-inset-bottom));
  }

  body {
    margin: 0; padding: 0;
    background: var(--bg-core);
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', Roboto, sans-serif;
    color: var(--text-main);
    overflow-x: hidden;
    overscroll-behavior-y: none; /* –ë–ª–æ–∫–∏—Ä—É–µ–º "—Ä–µ–∑–∏–Ω–∫—É" –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
  }

  /* === FX BACKGROUND === */
  .fx-layer { position: fixed; inset: 0; z-index: -1; pointer-events: none; }
  .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4; will-change: transform; animation: float 20s infinite linear; }
  .orb-1 { width: 300px; height: 300px; background: #5e60ce; top: -10%; left: -20%; }
  .orb-2 { width: 250px; height: 250px; background: #0a84ff; bottom: 10%; right: -10%; animation-duration: 25s; animation-direction: reverse; }
  @keyframes float { 0%{transform:rotate(0deg) translate(0,0)} 50%{transform:rotate(180deg) translate(20px,20px)} 100%{transform:rotate(360deg) translate(0,0)} }
  .noise { position: fixed; inset: 0; opacity: 0.05; background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E"); }

  /* === LAYOUT === */
  .main-scroll {
    height: 100vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: var(--safe-bottom);
    position: relative;
    z-index: 1;
  }

  /* === 1. STICKY HEADER (CALENDAR) === */
  .header-sticky {
    position: sticky; top: 0; z-index: 50;
    background: rgba(5, 5, 5, 0.85);
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--surface-border);
    padding-top: env(safe-area-inset-top);
  }
  
  .calendar-strip {
    display: flex; gap: 8px;
    padding: 12px 16px;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
  }
  
  .day-capsule {
    flex: 0 0 auto;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    width: 50px; height: 64px;
    background: var(--surface-glass);
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-m);
    transition: all 0.2s ease;
    scroll-snap-align: center;
    cursor: pointer;
  }
  .day-capsule.active {
    background: #fff;
    border-color: #fff;
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(255,255,255,0.15);
  }
  .day-name { font-size: 11px; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 2px; }
  .day-capsule.active .day-name { color: #000; opacity: 0.6; }
  .day-num { font-size: 18px; font-weight: 700; color: #fff; }
  .day-capsule.active .day-num { color: #000; }
  
  .total-summary {
    display: flex; justify-content: space-between; align-items: center;
    padding: 0 20px 12px 20px;
    font-size: 13px; font-weight: 500; color: var(--text-muted);
  }
  .sum-val { color: #fff; font-weight: 700; }

  /* === 2. DASHBOARD (MACROS + WATER) === */
  .dashboard { padding: 16px; display: flex; flex-direction: column; gap: 12px; }

  /* Macros Grid */
  .macros-card {
    background: var(--surface-glass);
    border: 1px solid var(--surface-border);
    border-top: 1px solid rgba(255,255,255,0.2);
    border-radius: var(--radius-xl);
    padding: 16px;
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px;
  }
  .macro-item { display: flex; flex-direction: column; align-items: center; position: relative; }
  .donut-box { width: 100%; max-width: 70px; aspect-ratio: 1; position: relative; display: flex; align-items: center; justify-content: center; }
  .mini-donut { width: 100%; height: 100%; transform: rotate(-90deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
  .md-bg { fill: none; stroke: rgba(255,255,255,0.06); stroke-width: 6; }
  .md-val { fill: none; stroke-width: 6; stroke-linecap: round; stroke-dasharray: 151; transition: stroke-dashoffset 1s ease; }
  
  /* Gradients refs via CSS vars or SVG defs at bottom */
  .stroke-kcal { stroke: url(#grad-kcal); }
  .stroke-prot { stroke: url(#grad-prot); }
  .stroke-fats { stroke: url(#grad-fats); }
  .stroke-carb { stroke: url(#grad-carb); }
  
  .m-icon { position: absolute; font-size: 16px; }
  .m-val { font-size: 13px; font-weight: 800; margin-top: 6px; }
  .m-lbl { font-size: 10px; color: var(--text-muted); font-weight: 600; text-transform: uppercase; }

  /* Water Tracker Row */
  .water-row {
    display: flex; gap: 12px; height: 80px;
  }
  .water-widget {
    flex: 1;
    background: linear-gradient(135deg, rgba(10,132,255,0.15) 0%, rgba(10,132,255,0.05) 100%);
    border: 1px solid rgba(10,132,255,0.2);
    border-radius: var(--radius-l);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 20px;
    position: relative; overflow: hidden;
  }
  .water-info { z-index: 2; display: flex; flex-direction: column; gap: 4px; }
  .water-title { font-size: 12px; color: #60a5fa; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
  .water-val { font-size: 22px; font-weight: 800; color: #fff; }
  .water-val span { font-size: 14px; font-weight: 500; opacity: 0.7; }
  
  /* –í–æ–ª–Ω—ã –≤–Ω—É—Ç—Ä–∏ –≤–∏–¥–∂–µ—Ç–∞ –≤–æ–¥—ã */
  .w-wave-bg {
    position: absolute; bottom: -10px; right: -20px;
    width: 100px; height: 100px;
    background: var(--acc-blue); opacity: 0.3;
    border-radius: 38%;
    animation: waveRotate 6s infinite linear;
    filter: blur(10px);
  }
  .w-wave-fg {
    position: absolute; bottom: -30px; right: -10px;
    width: 90px; height: 90px;
    background: var(--acc-blue); opacity: 0.6;
    border-radius: 40%;
    animation: waveRotate 4s infinite linear reverse;
  }
  @keyframes waveRotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  .water-actions { display: flex; flex-direction: column; gap: 6px; }
  .w-btn {
    width: 56px; height: 37px;
    background: var(--surface-glass); border: 1px solid var(--surface-border);
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 12px; font-weight: 700; color: #fff;
    transition: transform 0.1s; cursor: pointer;
  }
  .w-btn:active { transform: scale(0.95); background: rgba(255,255,255,0.15); }

  /* === 3. TIMELINE (MEAL FEED) === */
  .timeline { padding: 0 16px; display: flex; flex-direction: column; gap: 16px; }
  .timeline-title { font-size: 17px; font-weight: 700; margin-left: 4px; opacity: 0.9; }
  
  .meal-card {
    background: var(--surface-glass);
    border-radius: var(--radius-l);
    padding: 16px;
    display: flex; align-items: center; gap: 16px;
    border: 1px solid transparent;
    transition: background 0.2s;
  }
  .meal-card:active { background: var(--surface-active); }
  
  .meal-time {
    font-size: 13px; font-weight: 600; color: var(--text-muted);
    display: flex; flex-direction: column; align-items: center; gap: 2px;
    min-width: 40px;
  }
  .meal-line { width: 2px; height: 24px; background: rgba(255,255,255,0.1); border-radius: 2px; margin-top: 4px; }
  
  .meal-content { flex: 1; }
  .meal-name { font-size: 16px; font-weight: 700; color: #fff; margin-bottom: 4px; }
  .meal-desc { font-size: 13px; color: var(--text-muted); line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
  
  .meal-meta { text-align: right; }
  .meal-kcal { font-size: 16px; font-weight: 700; color: #fff; }
  .meal-tag { font-size: 11px; padding: 2px 6px; border-radius: 6px; background: rgba(255,255,255,0.1); color: var(--text-muted); margin-top: 4px; display: inline-block;}

  /* Empty State */
  .empty-state { text-align: center; padding: 40px 0; opacity: 0.5; }
  .empty-icon { font-size: 40px; margin-bottom: 10px; filter: grayscale(1); }

  /* === 4. OMNI-BAR (SMART DOCK) === */
  .omni-wrapper {
    position: fixed; bottom: 0; left: 0; right: 0;
    background: rgba(10, 10, 10, 0.85);
    backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
    padding: 10px 16px calc(10px + env(safe-area-inset-bottom)) 16px;
    border-top: 1px solid rgba(255,255,255,0.1);
    z-index: 100;
    display: flex; gap: 10px; align-items: center;
  }

  /* Menu Button [+] */
  .omni-btn {
    width: 44px; height: 44px; border-radius: 50%; flex-shrink: 0;
    background: rgba(255,255,255,0.08);
    display: flex; align-items: center; justify-content: center;
    color: #fff; transition: 0.2s; cursor: pointer;
  }
  .omni-btn:active { background: rgba(255,255,255,0.2); transform: scale(0.95); }
  .omni-btn svg { width: 24px; height: 24px; }

  /* Camera Button [üì∏] */
  .omni-cam {
    width: 44px; height: 44px; border-radius: 14px; flex-shrink: 0;
    background: linear-gradient(135deg, var(--acc-blue), #5e60ce);
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 12px rgba(10, 132, 255, 0.3);
    transition: 0.2s; cursor: pointer;
  }
  .omni-cam:active { transform: scale(0.92); filter: brightness(1.1); }

  /* Input Field */
  .omni-input-box {
    flex: 1; height: 44px;
    background: rgba(255,255,255,0.08);
    border-radius: 22px;
    display: flex; align-items: center;
    padding: 0 16px;
    border: 1px solid transparent;
    transition: 0.2s;
  }
  .omni-input-box:focus-within {
    background: rgba(255,255,255,0.12);
    border-color: rgba(255,255,255,0.2);
  }
  .omni-input {
    width: 100%; background: transparent; border: none;
    color: #fff; font-size: 16px;
    padding: 0; margin: 0;
  }
  .omni-input::placeholder { color: rgba(255,255,255,0.4); }

  /* Send Button (Hidden by default) */
  .omni-send {
    width: 36px; height: 36px; border-radius: 50%;
    background: var(--acc-green);
    display: flex; align-items: center; justify-content: center;
    margin-right: -8px;
    transform: scale(0); transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  .omni-input:not(:placeholder-shown) + .omni-send { transform: scale(1); }

  /* === FATSECRET MENU (ACTION SHEET) === */
  .sheet-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 150;
    opacity: 0; pointer-events: none; transition: opacity 0.3s;
    backdrop-filter: blur(4px);
  }
  .sheet-overlay.visible { opacity: 1; pointer-events: auto; }
  
  .action-sheet {
    position: fixed; bottom: 0; left: 0; right: 0;
    background: #1c1c1e;
    border-radius: 24px 24px 0 0;
    padding: 24px 16px calc(24px + env(safe-area-inset-bottom)) 16px;
    transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.1, 0.7, 0.1, 1);
    z-index: 151;
    border-top: 1px solid rgba(255,255,255,0.1);
  }
  .sheet-overlay.visible .action-sheet { transform: translateY(0); }
  
  .sheet-title { font-size: 13px; font-weight: 600; color: var(--text-muted); text-align: center; margin-bottom: 16px; text-transform: uppercase; }
  .sheet-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  
  .sheet-btn {
    background: rgba(255,255,255,0.08);
    border-radius: 16px;
    padding: 16px;
    display: flex; flex-direction: column; align-items: center; gap: 10px;
    font-size: 14px; font-weight: 600; color: #fff;
    cursor: pointer;
  }
  .sheet-btn:active { background: rgba(255,255,255,0.15); }
  .sheet-icon { font-size: 24px; }

  /* FatSecret specific style */
  .fs-btn { border: 1px solid rgba(48, 209, 88, 0.3); background: rgba(48, 209, 88, 0.1); color: var(--acc-green); }

</style>
</head>
<body>

<svg width="0" height="0" style="position:absolute">
  <defs>
    <linearGradient id="grad-kcal" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ff9f0a"/><stop offset="100%" stop-color="#ff453a"/></linearGradient>
    <linearGradient id="grad-prot" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#48bfe3"/><stop offset="100%" stop-color="#5e60ce"/></linearGradient>
    <linearGradient id="grad-fats" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#f1c40f"/><stop offset="100%" stop-color="#e67e22"/></linearGradient>
    <linearGradient id="grad-carb" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#2ecc71"/><stop offset="100%" stop-color="#1abc9c"/></linearGradient>
  </defs>
</svg>

<div class="fx-layer"><div class="orb orb-1"></div><div class="orb orb-2"></div><div class="noise"></div></div>

<div class="header-sticky">
  <div class="calendar-strip" id="calendarStrip">
    </div>
  <div class="total-summary">
    <span>–ò—Ç–æ–≥–æ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</span>
    <span class="sum-val">1450 / 2100 –∫–∫–∞–ª</span>
  </div>
</div>

<div class="main-scroll">
  
  <div class="dashboard">
    <div class="macros-card">
      <div class="macro-item">
        <div class="donut-box">
          <svg class="mini-donut" viewBox="0 0 60 60">
            <circle class="md-bg" cx="30" cy="30" r="24"/>
            <circle class="md-val stroke-kcal" cx="30" cy="30" r="24" style="stroke-dashoffset: 40px"/>
          </svg>
          <div class="m-icon">üî•</div>
        </div>
        <div class="m-val">1450</div>
        <div class="m-lbl">–ö–∫–∞–ª</div>
      </div>
      <div class="macro-item">
        <div class="donut-box">
          <svg class="mini-donut" viewBox="0 0 60 60">
            <circle class="md-bg" cx="30" cy="30" r="24"/>
            <circle class="md-val stroke-prot" cx="30" cy="30" r="24" style="stroke-dashoffset: 100px"/>
          </svg>
          <div class="m-icon">üêì</div>
        </div>
        <div class="m-val">150</div>
        <div class="m-lbl">–ë–µ–ª–∫–∏</div>
      </div>
      <div class="macro-item">
        <div class="donut-box">
          <svg class="mini-donut" viewBox="0 0 60 60">
            <circle class="md-bg" cx="30" cy="30" r="24"/>
            <circle class="md-val stroke-fats" cx="30" cy="30" r="24" style="stroke-dashoffset: 110px"/>
          </svg>
          <div class="m-icon">ü•ë</div>
        </div>
        <div class="m-val">45</div>
        <div class="m-lbl">–ñ–∏—Ä—ã</div>
      </div>
      <div class="macro-item">
        <div class="donut-box">
          <svg class="mini-donut" viewBox="0 0 60 60">
            <circle class="md-bg" cx="30" cy="30" r="24"/>
            <circle class="md-val stroke-carb" cx="30" cy="30" r="24" style="stroke-dashoffset: 60px"/>
          </svg>
          <div class="m-icon">üåæ</div>
        </div>
        <div class="m-val">180</div>
        <div class="m-lbl">–£–≥–ª–∏</div>
      </div>
    </div>

    <div class="water-row">
      <div class="water-widget">
        <div class="w-wave-bg"></div><div class="w-wave-fg"></div>
        <div class="water-info">
          <div class="water-title">–í–æ–¥–∞</div>
          <div class="water-val" id="waterVal">1.2 <span>–ª</span></div>
        </div>
        <div style="flex:1"></div>
      </div>
      <div class="water-actions">
        <div class="w-btn" onclick="addWater(250)">+250</div>
        <div class="w-btn" onclick="addWater(500)">+500</div>
      </div>
    </div>
  </div>

  <div class="timeline">
    <div class="timeline-title">–°–µ–≥–æ–¥–Ω—è</div>
    
    <div id="mealFeed">
      <div class="meal-card">
        <div class="meal-time"><span>09:00</span><div class="meal-line"></div></div>
        <div class="meal-content">
          <div class="meal-name">–û–≤—Å—è–Ω–∞—è –∫–∞—à–∞</div>
          <div class="meal-desc">–ù–∞ –º–æ–ª–æ–∫–µ, —Å –º–µ–¥–æ–º –∏ –æ—Ä–µ—Ö–∞–º–∏ (–≥—Ä–µ—Ü–∫–∏–µ 20–≥)</div>
        </div>
        <div class="meal-meta">
          <div class="meal-kcal">350</div>
          <div class="meal-tag">–ó–∞–≤—Ç—Ä–∞–∫</div>
        </div>
      </div>

      <div class="meal-card">
        <div class="meal-time"><span>13:30</span><div class="meal-line"></div></div>
        <div class="meal-content">
          <div class="meal-name">–ë–∏–∑–Ω–µ—Å-–ª–∞–Ω—á</div>
          <div class="meal-desc">–ö—É—Ä–∏–Ω—ã–π —Å—É–ø, –≥—Ä–µ—á–∫–∞, –∫–æ—Ç–ª–µ—Ç–∞ –Ω–∞ –ø–∞—Ä—É</div>
        </div>
        <div class="meal-meta">
          <div class="meal-kcal">620</div>
          <div class="meal-tag">–û–±–µ–¥</div>
        </div>
      </div>
    </div>
    
    <div style="height: 80px;"></div>
  </div>
</div>

<div class="omni-wrapper">
  <div class="omni-btn" onclick="toggleMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
  </div>
  
  <div class="omni-cam" onclick="openCamera()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
  </div>

  <div class="omni-input-box">
    <input type="text" class="omni-input" placeholder="–Ø–±–ª–æ–∫–æ 200–≥, –∫–æ—Ñ–µ..." id="txtInput">
    <div class="omni-send" onclick="sendText()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</div>

<div class="sheet-overlay" id="menuOverlay" onclick="toggleMenu()">
  <div class="action-sheet" onclick="event.stopPropagation()">
    <div class="sheet-title">–î–æ–±–∞–≤–∏—Ç—å</div>
    <div class="sheet-grid">
      <div class="sheet-btn fs-btn" onclick="openFatSecret()">
        <div class="sheet-icon">ü•ó</div>
        <div>FatSecret (PDF)</div>
      </div>
      <div class="sheet-btn" onclick="alert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
        <div class="sheet-icon">üîó</div>
        <div>–í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É</div>
      </div>
      <div class="sheet-btn" onclick="alert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
        <div class="sheet-icon">üè∑Ô∏è</div>
        <div>–®—Ç—Ä–∏—Ö–∫–æ–¥</div>
      </div>
    </div>
  </div>
</div>

<script>
  const tg = window.Telegram?.WebApp;
  if(tg) {
    tg.ready(); tg.expand();
    tg.setHeaderColor('#050505'); tg.setBackgroundColor('#050505');
    if(tg.disableVerticalSwipes) tg.disableVerticalSwipes();
  }

  // === CALENDAR LOGIC ===
  function initCalendar() {
    const container = document.getElementById('calendarStrip');
    const today = new Date();
    const weekDays = ['–í—Å','–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±'];
    
    // Generate ¬±3 days
    for(let i=-3; i<=3; i++) {
      const d = new Date();
      d.setDate(today.getDate() + i);
      
      const isToday = i === 0;
      const el = document.createElement('div');
      el.className = `day-capsule ${isToday ? 'active' : ''}`;
      el.innerHTML = `
        <div class="day-name">${weekDays[d.getDay()]}</div>
        <div class="day-num">${d.getDate()}</div>
      `;
      el.onclick = () => {
        document.querySelectorAll('.day-capsule').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        haptic('selection');
      };
      container.appendChild(el);
    }
    // Scroll to center
    setTimeout(() => {
      const center = container.children[3];
      if(center) center.scrollIntoView({behavior: 'auto', inline: 'center'});
    }, 10);
  }

  // === WATER LOGIC ===
  let waterL = 1.2;
  function addWater(ml) {
    haptic('medium');
    waterL += (ml / 1000);
    document.getElementById('waterVal').innerHTML = `${waterL.toFixed(1)} <span>–ª</span>`;
    // Animate wave (visual hack via opacity/speed in real app)
  }

  // === NAVIGATION & ACTIONS ===
  function openCamera() {
    haptic('light');
    // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ç–≤–æ–π —Ñ–∞–π–ª –∫–∞–º–µ—Ä—ã
    setTimeout(() => window.location.href = 'cam.html', 50);
  }

  function sendText() {
    const inp = document.getElementById('txtInput');
    const txt = inp.value.trim();
    if(!txt) return;
    
    haptic('light');
    inp.value = '';
    inp.blur(); // Hide keyboard
    
    // Simulating add to timeline
    const feed = document.getElementById('mealFeed');
    const card = document.createElement('div');
    card.className = 'meal-card';
    const now = new Date();
    const timeStr = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
    
    card.innerHTML = `
        <div class="meal-time"><span>${timeStr}</span><div class="meal-line"></div></div>
        <div class="meal-content">
          <div class="meal-name">${txt}</div>
          <div class="meal-desc">–û–±—Ä–∞–±–æ—Ç–∫–∞ AI...</div>
        </div>
        <div class="meal-meta"><div class="meal-kcal">...</div></div>
    `;
    // Insert after first item to keep order or append
    feed.prepend(card);
  }

  function toggleMenu() {
    haptic('light');
    const ov = document.getElementById('menuOverlay');
    ov.classList.toggle('visible');
  }

  function openFatSecret() {
    haptic('light');
    // –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ PDF –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–≥—Ä—É–∑–∫–∏
    alert('–ó–¥–µ—Å—å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –∑–∞–≥—Ä—É–∑–∫–∏ PDF –∏–∑ FatSecret');
    toggleMenu();
  }

  function haptic(style) {
    if(tg?.HapticFeedback) tg.HapticFeedback.impactOccurred(style);
  }

  // Init
  document.addEventListener('DOMContentLoaded', () => {
    initCalendar();
  });

</script>
</body>
</html>
