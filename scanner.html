<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>Food AI</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    /* ==========================================
       –†–ê–ó–î–ï–õ 1: –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
       (–ö–æ–ø–∏—è –∏–∑ measurements.html + ai.html)
       ========================================== */
    :root {
      /* –®—Ä–∏—Ñ—Ç—ã –∏ —Ü–≤–µ—Ç–∞ –∏–∑ measurements.html */
      --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      --bg: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      --text-primary: #fff;
      --text-secondary: rgba(255,255,255,.9);
      
      /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ (measurements.html) */
      --cardA: rgba(255,255,255,.18);
      --cardB: rgba(255,255,255,.16);
      --border: rgba(255,255,255,.28);
      --shadow: 0 8px 28px rgba(0,0,0,.18);
      
      /* –¶–≤–µ—Ç–∞ –∫–Ω–æ–ø–æ–∫ (measurements.html + ai.html) */
      --okA: #fbbf24; 
      --okB: #f59e0b;
      
      /* –ü—É–∑—ã—Ä–∏ —á–∞—Ç–∞ (–∏–∑ ai.html) */
      --userBubble: rgba(251,191,36,.25);
      --userBorder: rgba(251,191,36,.4);
      --aiBubble: rgba(255,255,255,.18);
      --aiBorder: rgba(255,255,255,.28);
      
      /* –ò–Ω–ø—É—Ç (–∏–∑ ai.html) */
      --inputBg: rgba(255,255,255,.12);
      --inputBorder: rgba(255,255,255,.24);
    }

    /* –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π */
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    html { font-family: var(--font-family); font-size: 16px; }
    body {
      min-height: 100vh;
      color: var(--text-primary);
      /* –§–æ–Ω –ø–æ–¥–ª–æ–∂–∫–∞ */
      position: relative; isolation: isolate;
    }
    body::before {
      content: ""; position: fixed; inset: 0; background: var(--bg); z-index: 0; pointer-events: none;
    }

    .page {
      position: relative; z-index: 1;
      max-width: 560px; margin: 0 auto; padding: 18px 14px 24px;
    }

    /* ==========================================
       –†–ê–ó–î–ï–õ 2: –ê–ö–ö–û–†–î–ï–û–ù (–î–∏–∑–∞–π–Ω measurements.html)
       ========================================== */
    /* –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–µ–∫—Ü–∏–∏ */
    .section {
      background: linear-gradient(180deg, var(--cardA), var(--cardB));
      border: 1px solid var(--border);
      border-radius: 18px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      overflow: hidden;
      margin-bottom: 14px;
      transition: all 0.3s ease;
    }

    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ */
    .section-h {
      display: flex; align-items: center; gap: 10px;
      padding: 14px 16px;
      cursor: pointer; user-select: none;
    }
    
    /* –¢–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ (H2 –∏–∑ measurements) */
    .section-h h2 {
      font-size: 1rem; /* ~16px */
      font-weight: 800;
      flex: 1;
    }

    /* –ö—Ä—É–∂–æ–∫ —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π (–¢–æ—á–Ω–∞—è –∫–æ–ø–∏—è logic) */
    .toggle {
      width: 22px; height: 22px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      opacity: .9;
    }
    .toggle svg {
      transition: transform .18s ease;
    }
    
    /* –ü–æ–≤–æ—Ä–æ—Ç —Å—Ç—Ä–µ–ª–∫–∏: –≤ measurements.html –ø—Ä–∏ collapsed –æ–Ω–∞ -90deg */
    .section.collapsed .toggle svg {
      transform: rotate(-90deg);
    }
    
    /* –ö–æ–Ω—Ç–µ–Ω—Ç —Å–µ–∫—Ü–∏–∏ */
    .section-content {
      padding: 0; /* –£–±–∏—Ä–∞–µ–º –ø–∞–¥–¥–∏–Ω–≥, —Ç–∞–∫ –∫–∞–∫ —á–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É */
    }
    .section.collapsed .section-content {
      display: none;
    }

    /* ==========================================
       –†–ê–ó–î–ï–õ 3: –ß–ê–¢ (–î–∏–∑–∞–π–Ω ai.html)
       ========================================== */
    .chat-container {
      display: flex; flex-direction: column;
      height: 460px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –æ–∫–Ω–∞ —á–∞—Ç–∞ */
      background: rgba(0,0,0,0.1); /* –õ–µ–≥–∫–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ —á–∞—Ç–∞ */
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto; overflow-x: hidden;
      padding: 16px 14px;
      display: flex; flex-direction: column; gap: 12px;
      -webkit-overflow-scrolling: touch;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
    .message {
      display: flex; flex-direction: column;
      max-width: 85%;
      animation: slideIn .3s ease;
      position: relative;
    }
    @keyframes slideIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

    .message.user { align-self: flex-end; align-items: flex-end; }
    .message.ai { align-self: flex-start; align-items: flex-start; }

    /* –ü—É–∑—ã—Ä—å —Å–æ–æ–±—â–µ–Ω–∏—è (–¢–æ—á–Ω–∞—è –∫–æ–ø–∏—è ai.html) */
    .message-bubble {
      padding: 12px 16px;
      border-radius: 18px;
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      font-size: 15px; line-height: 1.5;
      box-shadow: var(--shadow);
    }

    /* –°—Ç–∏–ª—å –ø—É–∑—ã—Ä—è USER */
    .message.user .message-bubble {
      background: linear-gradient(135deg, var(--userBubble), rgba(251,191,36,.2));
      border: 1px solid var(--userBorder);
      border-bottom-right-radius: 4px; /* –§–∏—Ä–º–µ–Ω–Ω—ã–π —É–≥–æ–ª–æ–∫ */
    }

    /* –°—Ç–∏–ª—å –ø—É–∑—ã—Ä—è AI */
    .message.ai .message-bubble {
      background: linear-gradient(180deg, var(--aiBubble), rgba(255,255,255,.14));
      border: 1px solid var(--aiBorder);
      border-bottom-left-radius: 4px; /* –§–∏—Ä–º–µ–Ω–Ω—ã–π —É–≥–æ–ª–æ–∫ */
    }
    
    /* –í–∏–¥–∂–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è —á–µ–∫–∞) */
    .fw-container { width: 100%; min-width: 220px; }
    .fw-header { font-weight: 800; font-size: 13px; text-transform: uppercase; opacity: 0.7; margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 4px; }
    .fw-row { display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 14px; }
    .fw-total { margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.2); font-weight: 900; color: var(--okA); display: flex; justify-content: space-between; }
    .fw-btn { margin-top: 12px; width: 100%; padding: 8px; border-radius: 10px; background: linear-gradient(135deg, var(--okA), var(--okB)); border:none; color: white; font-weight: 700; cursor: pointer; }
    .fw-btn.done { background: #22c55e; pointer-events: none; }

    /* ==========================================
       –†–ê–ó–î–ï–õ 4: –ü–ê–ù–ï–õ–¨ –í–í–û–î–ê (–î–∏–∑–∞–π–Ω ai.html)
       ========================================== */
    .input-area {
      padding: 12px 14px;
      background: transparent; /* –í ai.html —Ñ–æ–Ω –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π, —ç–ª–µ–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç —Å–≤–æ–π —Ñ–æ–Ω */
      display: flex; align-items: flex-end; gap: 10px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

    /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ */
    .input-field {
      flex: 1;
      min-height: 44px; max-height: 120px;
      padding: 12px 16px;
      border: 1px solid var(--inputBorder);
      border-radius: 22px; /* –†–∞–¥–∏—É—Å –∏–∑ ai.html */
      background: var(--inputBg);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      color: #fff; font-size: 15px; font-family: inherit;
      resize: none; outline: none;
    }
    .input-field::placeholder { color: rgba(255,255,255,.6); }
    .input-field:focus { border-color: var(--okA); box-shadow: 0 0 0 3px rgba(251,191,36,.2); }

    /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å (–ö—Ä—É–≥–ª–∞—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è) */
    .send-btn {
      width: 44px; height: 44px;
      border: 0; border-radius: 50%;
      background: linear-gradient(135deg, var(--okA), var(--okB));
      color: #fff;
      display: flex; align-items: center; justify-content: center;
      box-shadow: var(--shadow);
      flex-shrink: 0; cursor: pointer;
    }
    .send-btn:active { transform: scale(0.95); }
    
    /* –ö–Ω–æ–ø–∫–∞ –∫–∞–º–µ—Ä—ã (–°—Ç–∏–ª—å —Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ send-btn, –Ω–æ –¥—Ä—É–≥–æ–π —Ü–≤–µ—Ç –∏–ª–∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è) */
    .cam-btn-chat {
      width: 44px; height: 44px;
      border: 1px solid var(--inputBorder); border-radius: 50%;
      background: var(--inputBg);
      color: #fff;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; cursor: pointer;
      backdrop-filter: blur(8px);
    }

    /* ==========================================
       –†–ê–ó–î–ï–õ 5: –ö–ê–ú–ï–†–ê OVERLAY (–î–∏–∑–∞–π–Ω cam.html)
       ========================================== */
    #cam-overlay {
      position: fixed; inset: 0; z-index: 9999; background: #000;
      display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
    }
    .cam-video { width: 100%; height: 100%; object-fit: cover; }
    
    /* UI –ö–∞–º–µ—Ä—ã */
    .cam-top-bar {
      position: absolute; top: 16px; left: 0; right: 0; padding: 0 12px;
      display: flex; justify-content: space-between; z-index: 10;
    }
    .cam-icon {
      width: 40px; height: 40px; border-radius: 50%;
      background: rgba(0,0,0,0.48); border: 1px solid rgba(255,255,255,0.35);
      backdrop-filter: blur(10px);
      display: flex; align-items: center; justify-content: center;
      color: #fff; cursor: pointer;
    }
    
    .cam-bottom-bar {
      position: absolute; bottom: 0; left: 0; right: 0;
      padding: 20px;
      background: linear-gradient(to top, rgba(0,0,0,0.6), transparent);
      display: flex; flex-direction: column; align-items: center; gap: 16px;
    }
    
    .cam-comment-input {
      width: 100%; padding: 10px 12px;
      border-radius: 12px; border: 1px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.2); backdrop-filter: blur(4px);
      color: #fff; font-size: 14px; outline: none;
    }
    .cam-comment-input::placeholder { color: rgba(255,255,255,0.7); }

    .shutter {
      width: 72px; height: 72px;
      border-radius: 50%; border: 4px solid rgba(255,255,255,0.9);
      background: #fff; cursor: pointer;
      box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    }
    .shutter:active { transform: scale(0.95); }
    
    /* –ü—É–∑—ã—Ä–µ–∫ —É—Ä–æ–≤–Ω—è */
    .level-guide {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 140px; height: 140px; border-radius: 50%;
      pointer-events: none;
    }
    .level-target {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 23px; height: 23px; border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.6); background: rgba(0,0,0,0.1);
    }
    .level-bubble {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 20px; height: 20px; border-radius: 50%; background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4); transition: transform 0.1s linear;
    }
    .level-bubble.ok { background: #22c55e; }

  </style>
</head>
<body>

<div class="page">

  <section class="section" id="sec-food">
    <div class="section-h" onclick="toggleAccordion('sec-food')">
      <h2>–î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è</h2>
      <div class="toggle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M8 10l4 4 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>

    <div class="section-content">
      <div class="chat-container">
        
        <div class="chat-messages" id="chatFeed">
          <div class="message ai">
            <div class="message-bubble">
              –ü—Ä–∏–≤–µ—Ç! –ù–∞–∂–º–∏ –Ω–∞ –∫–∞–º–µ—Ä—É, —á—Ç–æ–±—ã —Å—Ñ–æ—Ç–∫–∞—Ç—å –µ–¥—É, –∏–ª–∏ –Ω–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç–æ–º.
            </div>
          </div>
        </div>

        <div class="input-area">
          <button class="cam-btn-chat" onclick="openCam()">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
              <circle cx="12" cy="13" r="4"/>
            </svg>
          </button>
          
          <textarea id="msgInput" class="input-field" rows="1" placeholder="–û–ø–∏—à–∏—Ç–µ –µ–¥—É..."></textarea>
          
          <button class="send-btn" onclick="sendText()">
            <svg viewBox="0 0 24 24" fill="none" width="20" height="20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </button>
        </div>

      </div>
    </div>
  </section>

  <section class="section collapsed" id="sec-stats">
    <div class="section-h" onclick="toggleAccordion('sec-stats')">
      <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
      <div class="toggle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M8 10l4 4 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>
    <div class="section-content" style="padding: 16px;">
      <div style="text-align:center; opacity:0.7;">–ó–¥–µ—Å—å –±—É–¥—É—Ç –≥—Ä–∞—Ñ–∏–∫–∏</div>
    </div>
  </section>

</div>

<div id="cam-overlay">
  <video id="camVideo" autoplay muted playsinline class="cam-video"></video>
  
  <div class="cam-top-bar">
    <div class="cam-icon" onclick="closeCam()">‚úï</div>
    <div class="cam-icon">‚ö°</div> 
  </div>

  <div class="level-guide">
    <div class="level-target"></div>
    <div id="levelBubble" class="level-bubble"></div>
  </div>

  <div class="cam-bottom-bar">
    <input type="text" id="camComment" class="cam-comment-input" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ —Ñ–æ—Ç–æ...">
    <button class="shutter" onclick="takePhoto()"></button>
  </div>
  
  <canvas id="camCanvas" style="display:none"></canvas>
</div>

<script>
  /* ==========================================
     –†–ê–ó–î–ï–õ 9: JAVASCRIPT –õ–û–ì–ò–ö–ê
     ========================================== */

  // --- 9.1 –ê–∫–∫–æ—Ä–¥–µ–æ–Ω ---
  function toggleAccordion(id) {
    const section = document.getElementById(id);
    section.classList.toggle('collapsed');
  }

  // --- 9.2 –ß–∞—Ç ---
  const feed = document.getElementById('chatFeed');
  const inp = document.getElementById('msgInput');

  function scrollToBottom() {
    feed.scrollTop = feed.scrollHeight;
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (Text/Photo)
  function addMessage(role, htmlContent) {
    const msg = document.createElement('div');
    msg.className = `message ${role}`;
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É–∑—ã—Ä—å
    const bubble = document.createElement('div');
    bubble.className = 'message-bubble';
    bubble.innerHTML = htmlContent;
    
    msg.appendChild(bubble);
    feed.appendChild(msg);
    scrollToBottom();
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–∞ "–ß–µ–∫"
  function addFoodWidget(data) {
    const msg = document.createElement('div');
    msg.className = 'message ai'; // –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ò–ò
    
    // –í–Ω—É—Ç—Ä–∏ –ø—É–∑—ã—Ä—è –≤–µ—Ä—Å—Ç–∞–µ–º "–ß–µ–∫"
    const bubble = document.createElement('div');
    bubble.className = 'message-bubble';
    bubble.style.padding = '0'; // –î–ª—è –≤–∏–¥–∂–µ—Ç–∞ —É–±–∏—Ä–∞–µ–º –ø–∞–¥–¥–∏–Ω–≥ –ø—É–∑—ã—Ä—è
    bubble.style.overflow = 'hidden'; // –ß—Ç–æ–±—ã —É–≥–ª—ã –Ω–µ —Ç–æ—Ä—á–∞–ª–∏

    let listHtml = '';
    data.items.forEach(item => {
      listHtml += `<div class="fw-row"><span>${item.name}</span><span>${item.kcal} –∫–∫–∞–ª</span></div>`;
    });

    const btnId = 'btn_' + Date.now();

    bubble.innerHTML = `
      <div class="fw-container" style="padding: 12px 16px;">
        <div class="fw-header">–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ</div>
        ${listHtml}
        <div class="fw-total">
          <span>–ò—Ç–æ–≥–æ:</span><span>${data.total} –∫–∫–∞–ª</span>
        </div>
        <button id="${btnId}" class="fw-btn" onclick="saveToLog('${btnId}')">‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å –≤ –¥–Ω–µ–≤–Ω–∏–∫</button>
      </div>
    `;
    
    msg.appendChild(bubble);
    feed.appendChild(msg);
    scrollToBottom();
  }

  function saveToLog(id) {
    const btn = document.getElementById(id);
    btn.innerText = '–ó–∞–ø–∏—Å–∞–Ω–æ ‚úì';
    btn.classList.add('done');
    // –¢—É—Ç –≤—ã–∑–æ–≤ –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    if(window.Telegram?.WebApp?.HapticFeedback) {
      window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
    }
  }

  // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞
  function sendText() {
    const txt = inp.value.trim();
    if(!txt) return;
    
    addMessage('user', txt);
    inp.value = '';
    
    // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
    setTimeout(() => {
      addFoodWidget({
        total: 250,
        items: [{name: txt, kcal: 250}]
      });
    }, 1000);
  }

  // --- 9.3 –ö–∞–º–µ—Ä–∞ ---
  const overlay = document.getElementById('cam-overlay');
  const video = document.getElementById('camVideo');
  const levelBubble = document.getElementById('levelBubble');
  let stream = null;

  async function openCam() {
    overlay.style.display = 'block';
    try {
      stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
      video.srcObject = stream;
      window.addEventListener('deviceorientation', handleOrientation);
    } catch(e) {
      alert('–û—à–∏–±–∫–∞ –∫–∞–º–µ—Ä—ã');
      closeCam();
    }
  }

  function closeCam() {
    overlay.style.display = 'none';
    if(stream) stream.getTracks().forEach(t => t.stop());
    window.removeEventListener('deviceorientation', handleOrientation);
  }

  function takePhoto() {
    // –§–µ–π–∫ –∑–∞—Ö–≤–∞—Ç–∞
    const canvas = document.getElementById('camCanvas');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext('2d').drawImage(video, 0, 0);
    
    const comment = document.getElementById('camComment').value;
    
    closeCam();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ —á–∞—Ç–µ (–∑–∞–≥–ª—É—à–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏)
    addMessage('user', `üì∑ [–§–æ—Ç–æ] <br> ${comment ? '<i>'+comment+'</i>' : ''}`);
    
    setTimeout(() => {
       addFoodWidget({
        total: 420,
        items: [{name: "–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π –æ–±–µ–¥", kcal: 420}]
      });
    }, 1500);
  }

  // --- 9.4 –ì–∏—Ä–æ—Å–∫–æ–ø (–ª–æ–≥–∏–∫–∞ –∏–∑ cam.html) ---
  function handleOrientation(event) {
    let x = event.gamma || 0; 
    let y = event.beta || 0;
    
    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ
    if(x > 20) x = 20; if(x < -20) x = -20;
    if(y > 20) y = 20; if(y < -20) y = -20;
    
    levelBubble.style.transform = `translate(calc(-50% + ${x*2}px), calc(-50% + ${y*2}px))`;
    
    if(Math.abs(x) < 3 && Math.abs(y) < 3) {
      levelBubble.classList.add('ok');
    } else {
      levelBubble.classList.remove('ok');
    }
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
  if(window.Telegram?.WebApp) {
      window.Telegram.WebApp.ready();
      window.Telegram.WebApp.expand();
  }

</script>
</body>
</html>
