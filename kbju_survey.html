<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Анкета</title>
<style>
:root {
  --bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --cardA: rgba(255,255,255,.18);
  --cardB: rgba(255,255,255,.16);
  --border: rgba(255,255,255,.28);
  --shadow: 0 8px 28px rgba(0,0,0,.18);
  --okA: #fbbf24;
  --okB: #f59e0b;
  --row: 36px;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  min-height: 100vh;
  background: var(--bg);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: #fff;
  padding: 18px 14px;
}

.container {
  max-width: 560px;
  margin: 0 auto;
}

.section {
  background: linear-gradient(180deg, var(--cardA), var(--cardB));
  border: 1px solid var(--border);
  border-radius: 18px;
  box-shadow: var(--shadow);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  overflow: hidden;
  margin-bottom: 14px;
}

.section-h {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  cursor: pointer;
  user-select: none;
}

.section-h h2 {
  font-size: 16px;
  font-weight: 800;
  flex: 1;
}

.toggle {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: .9;
}

.toggle svg {
  transition: transform .18s ease;
}

.section.collapsed .toggle svg {
  transform: rotate(-90deg);
}

.section-content {
  padding: 0;
}

.section.collapsed .section-content {
  display: none;
}

.field {
  padding: 12px;
}

.field + .field {
  border-top: 1px solid rgba(255,255,255,.14);
}

.row {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.label {
  font-size: 13px;
  font-weight: 800;
}

.unit {
  font-size: 12px;
  opacity: .9;
}

.help {
  margin-top: 6px;
  text-align: center;
  font-size: 12px;
  opacity: .8;
}

/* Binary buttons */
.binary-choice {
  display: flex;
  gap: 8px;
  padding: 12px;
  border-radius: 14px;
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.24);
  max-width: 320px;
  margin: 8px auto 0;
}

.binary-btn {
  flex: 1;
  padding: 10px 16px;
  border: 0;
  border-radius: 12px;
  background: rgba(255,255,255,.15);
  color: #fff;
  font-weight: 700;
  font-size: 14px;
  transition: all .2s ease;
  cursor: pointer;
}

.binary-btn.active {
  background: linear-gradient(135deg, var(--okA), var(--okB));
  box-shadow: 0 4px 12px rgba(251,191,36,.4), inset 0 1px 0 rgba(255,255,255,.3);
  transform: scale(1.02);
}

/* Dual-wheel picker */
.duo {
  position: relative;
  display: flex;
  gap: 6px;
  padding: 12px;
  border-radius: 14px;
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.24);
  max-width: 320px;
  margin: 8px auto 0;
  justify-content: center;
}

.duo::after {
  content: "";
  position: absolute;
  left: 4px;
  right: 4px;
  top: 50%;
  height: var(--row);
  transform: translateY(-50%);
  background: rgba(255,255,255,.14);
  border: 1px solid rgba(255,255,255,.35);
  border-radius: 10px;
  pointer-events: none;
}

.col {
  flex: 0 0 92px;
  height: 180px;
  overflow: auto;
  overscroll-behavior: contain;
  scrollbar-width: none;
  scroll-snap-type: y mandatory;
  mask-image: linear-gradient(180deg, transparent, #000 18%, #000 82%, transparent);
  -webkit-mask-image: linear-gradient(180deg, transparent, #000 18%, #000 82%, transparent);
}

.col::-webkit-scrollbar {
  display: none;
}

.option {
  height: var(--row);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 900;
  font-size: 18px;
  color: #eef2ff;
  opacity: .55;
  scroll-snap-align: center;
}

.option.active {
  color: #fff;
  opacity: 1;
  text-shadow: 0 1px 0 rgba(0,0,0,.2);
}

.sep {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 10px;
  color: #e5e7eb;
  font-weight: 800;
}

/* Choice lists */
.choice-list {
  padding: 12px;
  margin: 8px auto 0;
  max-width: 400px;
  border-radius: 14px;
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.24);
}

.choice-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  border-radius: 10px;
  cursor: pointer;
  transition: background .2s ease;
}

.choice-item:hover {
  background: rgba(255,255,255,.1);
}

.choice-item + .choice-item {
  margin-top: 6px;
}

.choice-checkbox {
  width: 22px;
  height: 22px;
  border: 2px solid rgba(255,255,255,.5);
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all .2s ease;
  flex-shrink: 0;
}

.choice-item.selected .choice-checkbox {
  background: linear-gradient(135deg, var(--okA), var(--okB));
  border-color: var(--okB);
}

.choice-check {
  opacity: 0;
  transform: scale(0.5);
  transition: all .2s ease;
  color: #fff;
  font-weight: 900;
}

.choice-item.selected .choice-check {
  opacity: 1;
  transform: scale(1);
}

.radio-circle {
  width: 22px;
  height: 22px;
  border: 2px solid rgba(255,255,255,.5);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all .2s ease;
  flex-shrink: 0;
}

.radio-circle::after {
  content: "";
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #fff;
  opacity: 0;
  transform: scale(0);
  transition: all .2s ease;
}

.choice-item.selected .radio-circle {
  background: linear-gradient(135deg, var(--okA), var(--okB));
  border-color: var(--okB);
}

.choice-item.selected .radio-circle::after {
  opacity: 1;
  transform: scale(1);
}

.choice-label {
  font-size: 14px;
  font-weight: 600;
  flex: 1;
}

/* Text input */
.text-input-wrap {
  padding: 12px;
  margin: 8px auto 0;
  max-width: 400px;
  border-radius: 14px;
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.24);
}

.text-input {
  width: 100%;
  padding: 12px 14px;
  border: 0;
  border-radius: 10px;
  background: rgba(255,255,255,.15);
  color: #fff;
  font-size: 14px;
  font-weight: 500;
  outline: none;
  transition: all .2s ease;
}

.text-input::placeholder {
  color: rgba(255,255,255,.5);
}

.text-input:focus {
  background: rgba(255,255,255,.22);
  box-shadow: 0 0 0 2px var(--okA);
}

/* Save button */
.savebar {
  display: flex;
  justify-content: center;
  padding: 12px;
  border-top: 1px solid rgba(255,255,255,.14);
}

.btn {
  min-width: 160px;
  padding: 12px 16px;
  border: 0;
  border-radius: 14px;
  background: #ED2F62;
  color: #fff;
  font-weight: 900;
  box-shadow: 0 12px 26px rgba(237,47,98,.35), inset 0 1px 0 rgba(255,255,255,.4);
  transition: transform .08s ease;
  cursor: pointer;
}

.btn.pressed {
  transform: translateY(1px) scale(.98);
}
</style>
</head>
<body>
<div class="container">
  
  <!-- Анкета -->
  <div class="section">
    <div class="section-h" onclick="toggleSection(this)">
      <h2>Анкета</h2>
      <div class="toggle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M8 10l4 4 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>
    <div class="section-content">
      
      <!-- Пол -->
      <div class="field">
        <div class="row"><div class="label">Пол</div></div>
        <div class="binary-choice">
          <button class="binary-btn" data-field="gender" data-value="male">Мужчина</button>
          <button class="binary-btn" data-field="gender" data-value="female">Женщина</button>
        </div>
        <div class="help">Выберите один вариант</div>
      </div>

      <!-- Вес -->
      <div class="field">
        <div class="row">
          <div class="label">Вес</div>
          <div class="unit">кг</div>
        </div>
        <div class="duo" id="weight-wheel">
          <div class="col col-int"></div>
          <div class="sep">,</div>
          <div class="col col-frac"></div>
        </div>
        <div class="help">кг: целые и десятые</div>
      </div>

      <!-- Цели -->
      <div class="field">
        <div class="row"><div class="label">Цели тренировок</div></div>
        <div class="choice-list" data-field="goals" data-type="multiple">
          <div class="choice-item" data-value="weight_loss">
            <div class="choice-checkbox"><span class="choice-check">✓</span></div>
            <div class="choice-label">Снижение веса</div>
          </div>
          <div class="choice-item" data-value="muscle_gain">
            <div class="choice-checkbox"><span class="choice-check">✓</span></div>
            <div class="choice-label">Набор массы</div>
          </div>
          <div class="choice-item" data-value="endurance">
            <div class="choice-checkbox"><span class="choice-check">✓</span></div>
            <div class="choice-label">Выносливость</div>
          </div>
        </div>
        <div class="help">Можно выбрать несколько</div>
      </div>

      <!-- Активность -->
      <div class="field">
        <div class="row"><div class="label">Уровень активности</div></div>
        <div class="choice-list" data-field="activity" data-type="single">
          <div class="choice-item" data-value="low">
            <div class="radio-circle"></div>
            <div class="choice-label">Малоподвижный</div>
          </div>
          <div class="choice-item" data-value="medium">
            <div class="radio-circle"></div>
            <div class="choice-label">Умеренный (3-5/нед)</div>
          </div>
          <div class="choice-item" data-value="high">
            <div class="radio-circle"></div>
            <div class="choice-label">Высокий (6-7/нед)</div>
          </div>
        </div>
        <div class="help">Выберите один вариант</div>
      </div>

      <!-- Комментарии -->
      <div class="field">
        <div class="row"><div class="label">Комментарии</div></div>
        <div class="text-input-wrap">
          <input type="text" class="text-input" data-field="comments" placeholder="Дополнительная информация...">
        </div>
        <div class="help">Необязательное поле</div>
      </div>

      <div class="savebar">
        <button class="btn" id="saveBtn">Сохранить</button>
      </div>
    </div>
  </div>

  <!-- Аналитика -->
  <div class="section">
    <div class="section-h" onclick="toggleSection(this)">
      <h2>Аналитика</h2>
      <div class="toggle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M8 10l4 4 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>
    <div class="section-content">
      <div class="field">
        <div class="help">Здесь появится динамика по ключевым метрикам после сохранения хотя бы двух замеров.</div>
      </div>
    </div>
  </div>

  <!-- Комментарий ИИ -->
  <div class="section">
    <div class="section-h" onclick="toggleSection(this)">
      <h2>Комментарий ИИ</h2>
      <div class="toggle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M8 10l4 4 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>
    <div class="section-content">
      <div class="field">
        <div class="help">Здесь будет краткий разбор изменений и рекомендации на основе последних замеров.</div>
      </div>
    </div>
  </div>

</div>

<script>
const data = {gender: null, weight: 70.0, goals: [], activity: null, comments: ''};

// Аккордеон
function toggleSection(header) {
  header.parentElement.classList.toggle('collapsed');
}

// Binary
document.querySelectorAll('.binary-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll(`[data-field="${btn.dataset.field}"].binary-btn`).forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    data[btn.dataset.field] = btn.dataset.value;
  });
});

// Wheel
function buildWheel(el, min, max, init) {
  const intCol = el.querySelector('.col-int');
  const fracCol = el.querySelector('.col-frac');
  const pad = 4, rowH = 36;
  const minInt = Math.floor(min), maxInt = Math.floor(max);
  
  function fill(col, from, to) {
    for(let i = 0; i < pad; i++) col.innerHTML += '<div class="option"></div>';
    for(let i = from; i <= to; i++) col.innerHTML += `<div class="option">${i}</div>`;
    for(let i = 0; i < pad; i++) col.innerHTML += '<div class="option"></div>';
  }
  fill(intCol, minInt, maxInt);
  fill(fracCol, 0, 9);
  
  function idx(col) {
    return Math.round((col.scrollTop + col.clientHeight/2 - rowH/2) / rowH) - pad;
  }
  
  function mark(col) {
    const i = idx(col);
    col.querySelectorAll('.option').forEach((o, n) => o.classList.toggle('active', n === i + pad));
  }
  
  function snap(col, i) {
    col.scrollTop = (i + pad) * rowH - col.clientHeight/2 + rowH/2;
  }
  
  function lock(v) {
    if (v === maxInt) {
      fracCol.style.pointerEvents = 'none';
      fracCol.style.opacity = '0.5';
    } else {
      fracCol.style.pointerEvents = 'auto';
      fracCol.style.opacity = '1';
    }
  }
  
  function update() {
    let iIdx = Math.max(0, Math.min(maxInt - minInt, idx(intCol)));
    let fIdx = Math.max(0, Math.min(9, idx(fracCol)));
    const iVal = minInt + iIdx;
    if (iVal === maxInt) fIdx = 0;
    snap(intCol, iIdx);
    snap(fracCol, fIdx);
    mark(intCol);
    mark(fracCol);
    lock(iVal);
    data.weight = parseFloat((iVal + fIdx/10).toFixed(1));
  }
  
  intCol.addEventListener('scroll', () => {
    mark(intCol);
    const iVal = minInt + Math.max(0, Math.min(maxInt - minInt, idx(intCol)));
    lock(iVal);
    if (iVal === maxInt) { snap(fracCol, 0); mark(fracCol); }
  });
  fracCol.addEventListener('scroll', () => mark(fracCol));
  intCol.addEventListener('scrollend', update);
  fracCol.addEventListener('scrollend', update);
  
  setTimeout(() => {
    const iIdx = Math.floor(init) - minInt;
    const fIdx = Math.round((init - Math.floor(init)) * 10);
    snap(intCol, iIdx);
    snap(fracCol, fIdx);
    mark(intCol);
    mark(fracCol);
    lock(Math.floor(init));
  }, 50);
}
buildWheel(document.getElementById('weight-wheel'), 40, 250, 70);

// Multiple
document.querySelectorAll('[data-type="multiple"]').forEach(list => {
  list.querySelectorAll('.choice-item').forEach(item => {
    item.addEventListener('click', () => {
      item.classList.toggle('selected');
      const v = item.dataset.value;
      const f = list.dataset.field;
      if (item.classList.contains('selected')) {
        if (!data[f].includes(v)) data[f].push(v);
      } else {
        data[f] = data[f].filter(x => x !== v);
      }
    });
  });
});

// Single
document.querySelectorAll('[data-type="single"]').forEach(list => {
  list.querySelectorAll('.choice-item').forEach(item => {
    item.addEventListener('click', () => {
      list.querySelectorAll('.choice-item').forEach(i => i.classList.remove('selected'));
      item.classList.add('selected');
      data[list.dataset.field] = item.dataset.value;
    });
  });
});

// Text
document.querySelectorAll('.text-input').forEach(input => {
  input.addEventListener('input', () => data[input.dataset.field] = input.value);
});

// Save
const saveBtn = document.getElementById('saveBtn');
['pointerdown','touchstart','mousedown'].forEach(e => 
  saveBtn.addEventListener(e, () => saveBtn.classList.add('pressed'), {passive:true})
);
['pointerup','pointercancel','mouseleave','touchend','touchcancel','mouseup'].forEach(e =>
  saveBtn.addEventListener(e, () => saveBtn.classList.remove('pressed'), {passive:true})
);
saveBtn.addEventListener('click', () => {
  console.log('Данные:', data);
  alert('Сохранено!\n\n' + JSON.stringify(data, null, 2));
});
</script>
</body>
</html>