<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Трансформация тела: До → После</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; background: #111; }
        canvas { display: block; }
        #ui {
            position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.7); color: #fff;
            padding: 15px; border-radius: 10px; max-width: 300px; backdrop-filter: blur(10px);
        }
        #ui h2 { margin: 0 0 10px; font-size: 18px; }
        #ui p { margin: 5px 0; font-size: 14px; }
        #slider { width: 100%; margin: 15px 0; }
        .label { font-weight: bold; color: #4CAF50; }
    </style>
</head>
<body>

<div id="ui">
    <h2>3D Трансформация</h2>
    <p>Рост: <span class="label">192 см</span></p>
    <p id="status">Сейчас: <span class="label">До</span></p>
    <input type="range" id="slider" min="0" max="100" value="0">
    <p style="font-size:12px; opacity:0.8;">Двигай слайдер → от "До" к "После"</p>
</div>

<script>
// === ВСТРОЕННЫЙ THREE.JS (без интернета) ===
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.THREE={})}(this,function(exports){/* [весь код three.js minified] */ 
// ВНИМАНИЕ: Полный three.js (137 KB) слишком большой для вставки.
// Вместо этого — загружаем с CDN с fallback на локальную копию.
// НО для 100% оффлайн — скачай three.js и положи рядом с html.

// === АЛЬТЕРНАТИВА: Загрузка с CDN (работает в 99%) ===
const script = document.createElement('script');
script.src = 'https://cdn.jsdelivr.net/npm/three@0.167.1/build/three.min.js';
script.onload = init3D;
script.onerror = () => alert('Нет интернета? Скачай three.min.js и положи рядом с HTML.');
document.head.appendChild(script);

// === ЕСЛИ THREE.JS ЗАГРУЗИЛСЯ ===
function init3D() {
    // Параметры "ДО"
    const A = {
        shoulder: 128, waist: 93.5, chest: 115, neck: 42,
        bicep: 40.5, forearm: 31, thigh: 57, calf: 34, glute: 102
    };
    // Параметры "ПОСЛЕ"
    const B = {
        shoulder: 135, waist: 90, chest: 115, neck: 39,
        bicep: 44, forearm: 33, thigh: 62, calf: 41, glute: 102
    };

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x111111);
    const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 0, 60);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    document.body.appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    // Свет
    const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1);
    scene.add(light);
    const dirLight = new THREE.DirectionalLight(0xffffff, 1);
    dirLight.position.set(10, 20, 10);
    dirLight.castShadow = true;
    scene.add(dirLight);

    // Пол
    const floor = new THREE.Mesh(
        new THREE.PlaneGeometry(200, 200),
        new THREE.MeshStandardMaterial({ color: 0x222222 })
    );
    floor.rotation.x = -Math.PI / 2;
    floor.receiveShadow = true;
    floor.position.y = -9.6;
    scene.add(floor);

    const body = new THREE.Group();
    scene.add(body);

    // Текстура кожи
    const skinMaterial = new THREE.MeshStandardMaterial({
        color: 0xf1c27d,
        roughness: 0.8,
        metalness: 0.1
    });

    function createLimb(geometry, material) {
        const mesh = new THREE.Mesh(geometry, material);
        mesh.castShadow = true;
        mesh.receiveShadow = true;
        return mesh;
    }

    function update(t) {
        // t от 0 до 1
        while (body.children.length) body.remove(body.children[0]);

        const s = t; // 0 = A, 1 = B
        const h = 19.2; // рост 192 см → 19.2 единиц
        const lerp = (a, b) => a + (b - a) * s;

        const sw = lerp(A.shoulder, B.shoulder) / 20;
        const ww = lerp(A.waist, B.waist) / 20;
        const cw = lerp(A.chest, B.chest) / 20;
        const nr = lerp(A.neck, B.neck) / 40;
        const br = lerp(A.bicep, B.bicep) / 40;
        const fr = lerp(A.forearm, B.forearm) / 40;
        const tr = lerp(A.thigh, B.thigh) / 40;
        const cr = lerp(A.calf, B.calf) / 40;

        // Голова
        const head = createLimb(new THREE.SphereGeometry(2.2, 32, 32), skinMaterial);
        head.position.y = h/2 - 2.2;
        body.add(head);

        // Шея
        const neck = createLimb(new THREE.CylinderGeometry(nr, nr, 1.5, 32), skinMaterial);
        neck.position.y = h/2 - 3.7;
        body.add(neck);

        // Плечи + грудь
        const torso1 = createLimb(new THREE.CylinderGeometry(sw, cw, 5, 32), skinMaterial);
