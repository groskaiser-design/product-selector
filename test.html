<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<title>Premium Dashboard</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  :root {
    /* --- –¶–í–ï–¢–ê –ò –§–û–ù --- */
    --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --text-primary: #ffffff;
    --text-secondary: rgba(255, 255, 255, 0.7);
    
    /* --- GLASSMORPHISM (–ü–†–ï–ú–ò–£–ú –°–¢–ï–ö–õ–û) --- */
    /* –°–µ–∫—Ä–µ—Ç –ø—Ä–µ–º–∏—É–º –≤–∏–¥–∞: —Ç–æ–Ω–∫–∏–µ —Å–≤–µ—Ç–ª—ã–µ —Ä–∞–º–∫–∏ —Å–≤–µ—Ä—Ö—É –∏ –ø–æ—á—Ç–∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —Å–Ω–∏–∑—É */
    --glass-bg: rgba(255, 255, 255, 0.10);
    --glass-border: 1px solid rgba(255, 255, 255, 0.15);
    --glass-bevel: 1px solid rgba(255, 255, 255, 0.3); /* –í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω—å */
    --glass-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
    --blur: 20px;
    
    /* --- –†–ê–ó–ú–ï–†–´ --- */
    --radius-xl: 28px; /* –í–∏–¥–∂–µ—Ç—ã */
    --radius-l: 20px;  /* –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é */
    --radius-m: 16px;  /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
    
    /* –ê–∫—Ü–µ–Ω—Ç (–ó–æ–ª–æ—Ç–æ–π/–Ø–Ω—Ç–∞—Ä–Ω—ã–π –¥–ª—è –≤–∞–∂–Ω—ã—Ö —Ü–∏—Ñ—Ä) */
    --accent: #fbbf24; 
  }

  /* –°–±—Ä–æ—Å –∏ –ë–∞–∑–∞ */
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, Helvetica, sans-serif;
    background: var(--bg-gradient);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    /* –£–±–∏—Ä–∞–µ–º –æ—Ç—Å–∫–æ–∫ –Ω–∞ iOS –¥–ª—è —Ç–µ–ª–∞, —á—Ç–æ–±—ã —Å–∫—Ä–æ–ª–ª–∏–ª–∏—Å—å —ç–ª–µ–º–µ–Ω—Ç—ã */
    overscroll-behavior-y: none; 
  }

  /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω (—á—Ç–æ–±—ã –Ω–µ –¥–µ—Ä–≥–∞–ª—Å—è) */
  .bg-layer {
    position: fixed; inset: 0; background: var(--bg-gradient); z-index: -1;
  }
  /* –î–æ–±–∞–≤–ª—è–µ–º —à—É–º/—Ç–µ–∫—Å—Ç—É—Ä—É –¥–ª—è –¥–æ—Ä–æ–≥–æ–≤–∏–∑–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) */
  .bg-layer::after {
    content: ""; position: absolute; inset: 0;
    background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIj48ZmlsdGVyIGlkPSJnoiPjZmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIwLjY1IiBudW1PY3RhdmVzPSIzIiBzdGl0Y2hUaWxlcz0ic3RpdGNoIi8+PC9maWx0ZXI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI2cpIiBvcGFjaXR5PSIwLjAzIi8+PC9zdmc+');
    opacity: 0.6; mix-blend-mode: overlay;
  }

  .app-container {
    max-width: 500px; margin: 0 auto;
    padding: 16px 20px 40px 20px; /* –û—Ç—Å—Ç—É–ø—ã */
    display: flex; flex-direction: column; gap: 28px;
    min-height: 100vh;
  }

  /* === 1. –ü–†–û–§–ò–õ–¨ (Compact & Clean) === */
  .header {
    display: flex; justify-content: space-between; align-items: center;
    padding-top: 8px;
  }
  .user-info {
    display: flex; align-items: center; gap: 14px;
  }
  .avatar-ring {
    padding: 3px; 
    background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0.1));
    border-radius: 50%;
  }
  .avatar {
    width: 48px; height: 48px; border-radius: 50%;
    background: #333; overflow: hidden;
    position: relative;
  }
  .avatar img { width: 100%; height: 100%; object-fit: cover; }
  .avatar-placeholder { 
    width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; 
    font-weight: 700; font-size: 18px; background: rgba(255,255,255,0.15); 
  }

  .texts { display: flex; flex-direction: column; }
  .greeting { font-size: 13px; color: var(--text-secondary); letter-spacing: 0.3px; }
  .username { font-size: 20px; font-weight: 700; letter-spacing: -0.5px; text-shadow: 0 2px 10px rgba(0,0,0,0.1); }

  .header-action {
    width: 40px; height: 40px; border-radius: 14px;
    background: var(--glass-bg);
    border: var(--glass-border);
    backdrop-filter: blur(10px);
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: transform 0.1s;
  }
  .header-action:active { transform: scale(0.92); }

  /* === 2. –í–ò–î–ñ–ï–¢–´ (Carousel - 1 per screen) === */
  .widgets-wrapper {
    position: relative;
    width: 100%;
  }
  
  .carousel-track {
    display: flex;
    gap: 16px;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox */
    padding-bottom: 4px;
  }
  .carousel-track::-webkit-scrollbar { display: none; } /* Chrome/Safari */

  /* –°—Ç–∏–ª—å –∫–∞—Ä—Ç–æ—á–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ */
  .widget-slide {
    flex: 0 0 100%; /* 1 —Å–ª–∞–π–¥ –Ω–∞ 100% —à–∏—Ä–∏–Ω—ã */
    scroll-snap-align: center;
    scroll-snap-stop: always;
    
    height: 180px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è */
    background: var(--glass-bg);
    /* –≠—Ñ—Ñ–µ–∫—Ç "–°–≤–µ—Ç —Å–≤–µ—Ä—Ö—É" */
    border-top: 1px solid rgba(255,255,255,0.4);
    border-bottom: 1px solid rgba(255,255,255,0.05);
    border-left: 1px solid rgba(255,255,255,0.15);
    border-right: 1px solid rgba(255,255,255,0.15);
    
    border-radius: var(--radius-xl);
    backdrop-filter: blur(var(--blur));
    -webkit-backdrop-filter: blur(var(--blur));
    box-shadow: var(--glass-shadow);
    
    padding: 24px;
    display: flex; flex-direction: column; justify-content: space-between;
    position: relative; overflow: hidden;
    transition: transform 0.2s;
  }
  /* –≠—Ñ—Ñ–µ–∫—Ç –≥–ª—É–±–∏–Ω—ã –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –≤–∏–¥–∂–µ—Ç */
  .widget-slide:active { transform: scale(0.98); }

  /* –ë–ª–∏–∫–∏ –Ω–∞ —Ñ–æ–Ω–µ –≤–∏–¥–∂–µ—Ç–∞ */
  .widget-slide::before {
    content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
    pointer-events: none;
  }

  /* –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∏–¥–∂–µ—Ç–∞ */
  .w-top { display: flex; justify-content: space-between; align-items: flex-start; z-index: 2; }
  .w-label { 
    font-size: 13px; font-weight: 700; text-transform: uppercase; 
    letter-spacing: 1px; color: rgba(255,255,255,0.6); 
    margin-bottom: 6px;
  }
  .w-main-text { font-size: 24px; font-weight: 800; line-height: 1.1; width: 85%; }
  .w-icon { font-size: 24px; opacity: 0.8; }

  .w-bottom { z-index: 2; }
  .w-sub { font-size: 14px; color: rgba(255,255,255,0.8); margin-top: 4px; }
  
  /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä –≤–Ω—É—Ç—Ä–∏ –≤–∏–¥–∂–µ—Ç–∞ */
  .w-progress-track {
    width: 100%; height: 6px; background: rgba(255,255,255,0.15); border-radius: 10px; margin-top: 12px;
    overflow: hidden;
  }
  .w-progress-fill {
    height: 100%; background: #fff; border-radius: 10px; width: 0;
    box-shadow: 0 0 10px rgba(255,255,255,0.5);
    transition: width 1s cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* –¢–æ—á–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ */
  .dots-container {
    display: flex; justify-content: center; gap: 8px; margin-top: 12px;
  }
  .dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: rgba(255,255,255,0.3);
    transition: all 0.3s ease;
  }
  .dot.active {
    background: #fff; width: 18px; border-radius: 10px;
    box-shadow: 0 0 8px rgba(255,255,255,0.4);
  }

  /* === 3. –°–ï–¢–ö–ê (Adaptive Grid) === */
  .grid-title {
    font-size: 18px; font-weight: 700; margin-bottom: 16px; margin-left: 4px;
    display: flex; align-items: center; gap: 8px;
  }
  
  .menu-grid {
    display: grid;
    /* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è, 3 –∫–æ–ª–æ–Ω–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ */
    grid-template-columns: repeat(3, 1fr); 
    gap: 14px;
  }

  .tile {
    aspect-ratio: 1; /* –ö–≤–∞–¥—Ä–∞—Ç */
    background: rgba(255, 255, 255, 0.07);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: var(--radius-l);
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;
    cursor: pointer;
    position: relative;
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    /* –õ–µ–≥–∫–∏–π –±–ª—é—Ä */
    backdrop-filter: blur(10px);
  }
  
  .tile:active {
    transform: scale(0.94);
    background: rgba(255, 255, 255, 0.15);
  }

  .tile-icon-box {
    width: 42px; height: 42px;
    /* –ü–æ–¥–ª–æ–∂–∫–∞ –ø–æ–¥ –∏–∫–æ–Ω–∫—É –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ */
    background: radial-gradient(circle at center, rgba(255,255,255,0.2), transparent 70%);
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
  }
  .tile-icon-box img {
    width: 28px; height: 28px; object-fit: contain;
    filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2)); /* –¢–µ–Ω—å –∏–∫–æ–Ω–∫–∏ */
  }

  .tile-name {
    font-size: 12px; font-weight: 600; text-align: center;
    color: rgba(255, 255, 255, 0.9);
    letter-spacing: 0.2px;
  }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
  .fade-in-up { animation: fadeInUp 0.6s ease forwards; opacity: 0; transform: translateY(20px); }
  @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

  /* === –õ–û–ê–î–ï–† === */
  #loader { position: fixed; inset: 0; background: rgba(0,0,0,0.3); backdrop-filter: blur(5px); z-index: 999; display: none; align-items: center; justify-content: center; }
  .spinner { width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.2); border-top-color: #fff; border-radius: 50%; animation: spin 0.8s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }

</style>
</head>
<body>

<div class="bg-layer"></div>
<div id="loader"><div class="spinner"></div></div>

<div class="app-container">
  
  <div class="header">
    <div class="user-info">
      <div class="avatar-ring">
        <div class="avatar" id="userAvatar">
          <div class="avatar-placeholder">?</div>
        </div>
      </div>
      <div class="texts">
        <div class="greeting">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å,</div>
        <div class="username" id="userName">–ì–æ—Å—Ç—å</div>
      </div>
    </div>
    <div class="header-action" onclick="haptic('light');">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
    </div>
  </div>

  <div class="widgets-wrapper">
    <div class="carousel-track" id="widgetTrack">
      </div>
    <div class="dots-container" id="dotsContainer">
      </div>
  </div>

  <div>
    <div class="grid-title">–ú–µ–Ω—é</div>
    <div class="menu-grid" id="menuGrid">
      </div>
  </div>

</div>

<script>
  // === CONFIG ===
  const ICON_BASE = 'https://groskaiser-design.github.io/icons/';
  
  // –ï—Å–ª–∏ –∏–∫–æ–Ω–æ–∫ —Å—Ç–∞–Ω–µ—Ç > 9, CSS Grid –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Å—Ç 4-–π —Ä—è–¥. –°–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–∑–≤–æ–ª–∏—Ç —ç—Ç–æ —É–≤–∏–¥–µ—Ç—å.
  // –≠—Ç–æ —Å–∞–º–æ–µ "–ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ" –∏ –ø–æ–Ω—è—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.
  const MENU_ITEMS = [
    { id: 'kbju',     name: '–ö–ë–ñ–£',       icon: 'clipboard.svg', link: 'kbju.html' },
    { id: 'measure',  name: '–ó–∞–º–µ—Ä—ã',     icon: 'scales.svg',    link: 'measurements.html' },
    { id: 'diary',    name: '–û—Ç—á—ë—Ç',      icon: 'diary.svg',     link: 'scanner.html' },
    { id: 'menu',     name: '–†–∞—Ü–∏–æ–Ω',     icon: 'menu.svg',      link: '#' },
    { id: 'ai',       name: 'AI-–ö–æ—É—á',    icon: 'ai.svg',        link: 'ai.html' },
    { id: 'analyt',   name: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞',  icon: 'analytics.svg', link: '2.html' },
    { id: 'profile',  name: '–ü—Ä–æ—Ñ–∏–ª—å',    icon: 'profile.svg',   link: '#' },
    { id: 'sub',      name: '–ü–æ–¥–ø–∏—Å–∫–∞',   icon: 'rub.svg',       link: '#' },
    { id: 'manual',   name: '–ò–Ω—Ñ–æ',       icon: 'question.svg',  link: '#' },
    // –ü—Ä–∏–º–µ—Ä 10-–π –∏–∫–æ–Ω–∫–∏ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –¥–ª—è —Ç–µ—Å—Ç–∞)
    // { id: 'shop',     name: '–ú–∞–≥–∞–∑–∏–Ω',    icon: 'cart.svg',      link: '#' },
  ];

  const WIDGETS = [
    {
      type: 'progress',
      label: '–ü–∏—Ç–∞–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è',
      title: '1250 / 2100 –∫–∫–∞–ª',
      subtitle: '–ë–µ–ª–∫–∏: 80–≥ ‚Ä¢ –ñ–∏—Ä—ã: 40–≥ ‚Ä¢ –£–≥–ª: 150–≥',
      percent: 60,
      icon: 'üî•'
    },
    {
      type: 'card',
      label: '–°–æ–≤–µ—Ç –¥–Ω—è',
      title: '–ü–µ–π—Ç–µ –≤–æ–¥—É –ø–µ—Ä–µ–¥ –µ–¥–æ–π',
      subtitle: '–°—Ç–∞–∫–∞–Ω –≤–æ–¥—ã –∑–∞ 20 –º–∏–Ω –¥–æ –µ–¥—ã —É–ª—É—á—à–∞–µ—Ç –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ.',
      icon: 'üíß'
    },
    {
      type: 'alert',
      label: '–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ',
      title: '–í—Ä–µ–º—è –∑–∞–º–µ—Ä–æ–≤!',
      subtitle: '–í—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∏ –≤–µ—Å —É–∂–µ 7 –¥–Ω–µ–π.',
      icon: 'üìÖ'
    }
  ];

  // === TELEGRAM INIT ===
  const tg = window.Telegram?.WebApp;
  if (tg) {
    tg.ready();
    tg.expand();
    tg.setHeaderColor('#667eea'); // –ü–æ–¥ —Ü–≤–µ—Ç —Ñ–æ–Ω–∞
    tg.BackButton?.hide(); // –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  }

  function haptic(style = 'light') {
    if (tg?.HapticFeedback) tg.HapticFeedback.impactOccurred(style);
  }

  // === RENDER FUNCTIONS ===

  function renderProfile() {
    const u = tg?.initDataUnsafe?.user || { first_name: '–ì–æ—Å—Ç—å' };
    document.getElementById('userName').textContent = u.first_name;
    
    if (u.photo_url) {
      document.getElementById('userAvatar').innerHTML = `<img src="${u.photo_url}" alt="avatar">`;
    }
  }

  function renderWidgets() {
    const track = document.getElementById('widgetTrack');
    const dots = document.getElementById('dotsContainer');
    
    WIDGETS.forEach((w, index) => {
      // 1. Slide
      const slide = document.createElement('div');
      slide.className = 'widget-slide';
      // Delay animation for nice entry
      slide.style.animation = `fadeInUp 0.6s ease forwards ${index * 0.1}s`;
      slide.style.opacity = '0'; 

      let content = `
        <div class="w-top">
          <div>
            <div class="w-label">${w.label}</div>
            <div class="w-main-text">${w.title}</div>
          </div>
          <div class="w-icon">${w.icon}</div>
        </div>
      `;

      if (w.type === 'progress') {
        content += `
          <div class="w-bottom">
            <div class="w-progress-track">
              <div class="w-progress-fill" style="width: ${w.percent}%"></div>
            </div>
            <div class="w-sub">${w.subtitle}</div>
          </div>
        `;
      } else {
        content += `
          <div class="w-bottom">
            <div class="w-sub" style="font-size: 15px; line-height: 1.4;">${w.subtitle}</div>
          </div>
        `;
      }

      slide.innerHTML = content;
      slide.onclick = () => {
        haptic('medium');
        // Logic to open widget details
      };
      track.appendChild(slide);

      // 2. Dot
      const dot = document.createElement('div');
      dot.className = `dot ${index === 0 ? 'active' : ''}`;
      dots.appendChild(dot);
    });

    // Scroll Observer for Dots
    const slides = document.querySelectorAll('.widget-slide');
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // Find index
          const index = Array.from(slides).indexOf(entry.target);
          updateDots(index);
        }
      });
    }, { root: track, threshold: 0.6 });

    slides.forEach(s => observer.observe(s));
  }

  function updateDots(activeIndex) {
    const dots = document.querySelectorAll('.dot');
    dots.forEach((d, i) => {
      d.classList.toggle('active', i === activeIndex);
    });
  }

  function renderGrid() {
    const grid = document.getElementById('menuGrid');
    
    MENU_ITEMS.forEach((item, index) => {
      const tile = document.createElement('div');
      tile.className = 'tile fade-in-up';
      tile.style.animationDelay = `${0.2 + (index * 0.05)}s`; // Staggered animation
      
      tile.onclick = () => {
        haptic('light');
        if (item.link && item.link !== '#') {
          setTimeout(() => window.location.href = item.link, 100);
        } else {
          tg?.showPopup({ title: '–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', message: `–†–∞–∑–¥–µ–ª "${item.name}" —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è.` });
        }
      };

      const iconUrl = ICON_BASE + item.icon;

      tile.innerHTML = `
        <div class="tile-icon-box">
          <img src="${iconUrl}" alt="${item.name}" loading="lazy">
        </div>
        <div class="tile-name">${item.name}</div>
      `;
      
      grid.appendChild(tile);
    });
  }

  // === BOOT ===
  document.addEventListener('DOMContentLoaded', () => {
    renderProfile();
    renderWidgets();
    renderGrid();
  });

</script>
</body>
</html>
