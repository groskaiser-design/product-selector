<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Router ‚Äî Variant B (Full Grid, Blur Others)</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  html,body{height:100%;scrollbar-gutter:stable both-edges}
  body{
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
    min-height:100vh;
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    padding:20px 16px 96px 16px;
    color:#111
  }
  .container{max-width:520px;margin:0 auto}

  /* –ü—Ä–æ—Ñ–∏–ª—å */
  .profile-card{
    background:rgba(255,255,255,.15);
    backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
    border-radius:24px;padding:24px;margin-bottom:24px;
    border:1px solid rgba(255,255,255,.2);
    box-shadow:0 8px 32px rgba(0,0,0,.12),inset 0 1px 0 rgba(255,255,255,.35);
    transition:filter .22s ease, opacity .22s ease
  }
  .profile-header{display:flex;gap:14px;align-items:center}
  .profile-photo{
    width:64px;height:64px;border-radius:50%;overflow:hidden;
    display:flex;align-items:center;justify-content:center;
    color:#fff;font-weight:700;
    background:linear-gradient(135deg,rgba(255,255,255,.35),rgba(255,255,255,.15));
    border:2px solid rgba(255,255,255,.25)
  }
  .profile-name{color:#fff;font-weight:800;font-size:18px}
  .profile-id{margin-top:4px;font-size:12px;display:inline-block;color:rgba(255,255,255,.9);
    background:rgba(255,255,255,.14);padding:3px 8px;border-radius:8px}
  .dim-header .profile-card{filter:blur(1px);opacity:.7}

  /* –°–µ—Ç–∫–∞ –ø–ª–∏—Ç–æ–∫ */
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;position:relative}
  .tile{position:relative;text-align:center;cursor:pointer;user-select:none;overflow:visible;
    transition:transform .18s ease, filter .22s ease, opacity .22s ease}
  .icon-wrap{width:72px;height:72px;margin:0 auto 10px;position:relative}
  .icon-bg{
    position:absolute;left:-2px;top:-2px;width:76px;height:76px;border-radius:22px;
    background:linear-gradient(135deg,rgba(255,255,255,.4),rgba(255,255,255,.1));opacity:.6;transition:opacity .2s,transform .2s
  }
  .icon{
    position:absolute;inset:0;margin:auto;width:72px;height:72px;border-radius:20px;
    background:rgba(255,255,255,.22);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
    border:1.5px solid rgba(255,255,255,.45);display:flex;align-items:center;justify-content:center;
    box-shadow:0 8px 24px rgba(0,0,0,.12),inset 0 1px 0 rgba(255,255,255,.55);transition:transform .18s ease,box-shadow .18s ease
  }
  .icon svg{width:36px;height:36px;stroke:#fff;fill:none;stroke-width:2.5;stroke-linecap:round;stroke-linejoin:round}
  .label{font-size:12px;font-weight:700;color:#fff;text-shadow:0 2px 4px rgba(0,0,0,.25)}
  .tile:active .icon{transform:scale(.92)}

  /* Hover (–¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞) */
  .tile:hover .icon{transform:translateY(-6px) scale(1.04);box-shadow:0 14px 28px rgba(0,0,0,.18),inset 0 1px 0 rgba(255,255,255,.6),0 0 24px rgba(102,126,234,.35)}
  .tile:hover .icon-bg{opacity:1;transform:scale(1.05)}
  .spawn:hover .icon{transform:translateY(-4px) scale(1.03)}
  .spawn:hover .icon-bg{opacity:1;transform:scale(1.05)}

  /* Ripple ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–¥–∏—É—Å (–∫–∞–∫ —Ä–∞–Ω—å—à–µ) */
  .tile .r{
    position:absolute;width:12px;height:12px;border-radius:999px;background:rgba(255,255,255,.35);
    left:0;top:0;transform:translate(-50%,-50%) scale(0);pointer-events:none;filter:blur(1px);
    animation:rr .6s ease-out forwards;will-change:transform,opacity
  }
  @keyframes rr{to{transform:translate(-50%,-50%) scale(22);opacity:0}}

  /* ==== Variant B: Arc Menu (glass) ==== */
  #startB{z-index:3}
  .spawn{
    position:absolute;left:50%;top:50%;width:90px;height:106px;
    transform:translate(-50%,-50%) rotate(0) translate(0) rotate(0);
    opacity:0;pointer-events:none;
    background:transparent;border:0;padding:0;appearance:none;-webkit-appearance:none
  }
  .spawn:focus{outline:none}
  .spawn .icon-wrap{width:72px;height:72px}
  .spawn .icon-bg{width:76px;height:76px;left:-2px;top:-2px;border-radius:22px}
  .spawn .label{margin-top:2px}

  .open-b .spawn{pointer-events:auto}
  .open-b .spawn.s1{opacity:1;transform:translate(-50%,-50%) rotate(-24deg) translate(148px) rotate(24deg)}
  .open-b .spawn.s2{opacity:1;transform:translate(-50%,-50%) rotate(24deg) translate(148px) rotate(-24deg)}
  .open-b .icon{transform:scale(.9)}

  /* –ë–ª—é—Ä–∏–º –≤—Å—ë, –∫—Ä–æ–º–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–ª–∏—Ç–∫–∏ */
  .grid.focus .tile{filter:blur(2px) saturate(.85);opacity:.18;transform:translateY(8px)}
  .grid.focus #startB{filter:none;opacity:1;transform:none}

  /* –§—É—Ç–µ—Ä */
  .footer{
    position:fixed;left:0;right:0;bottom:0;height:66px;background:rgba(255,255,255,.95);
    backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);border-top:1px solid rgba(0,0,0,.06);
    display:flex;align-items:center;justify-content:space-around;box-shadow:0 -6px 20px rgba(0,0,0,.1)
  }
  .nav{display:flex;flex-direction:column;align-items:center;gap:4px;color:#667085}
  .nav.active{color:#667eea}

  /* –¢–æ—Å—Ç (–¥–ª—è –ø—Ä–µ–≤—å—é) */
  #toast{
    position:fixed;left:50%;bottom:86px;transform:translateX(-50%);
    background:rgba(0,0,0,.82);color:#fff;padding:10px 14px;border-radius:10px;
    font-weight:700;z-index:1000;opacity:0;transition:opacity .2s
  }
</style>
</head>
<body>
  <div class="container">
    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="profile-card">
      <div class="profile-header">
        <div class="profile-photo" id="userPhoto">üë§</div>
        <div>
          <div class="profile-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
          <div class="profile-id" id="userId">ID: ---</div>
        </div>
      </div>
    </div>

    <!-- –ü–æ–ª–Ω–∞—è —Å–µ—Ç–∫–∞ -->
    <div class="grid" id="gridB">
      <!-- 1. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
      <div class="tile" data-module="manual">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
            <line x1="10" y1="8" x2="16" y2="8"/><line x1="10" y1="12" x2="16" y2="12"/>
          </svg></div></div>
        <div class="label">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</div>
      </div>

      <!-- 2. –°—Ç–∞—Ä—Ç -->
      <div class="tile" id="startB">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></svg></div>
        </div>
        <div class="label">–°—Ç–∞—Ä—Ç</div>

        <!-- –°–ø–∞–≤–Ω-–∏–∫–æ–Ω–∫–∏ -->
        <button class="spawn s1" id="btnProducts" aria-label="–í—ã–±–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–æ–≤">
          <div class="icon-wrap"><div class="icon-bg"></div>
            <div class="icon">
              <svg viewBox="0 0 24 24"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/></svg>
            </div>
          </div>
          <div class="label">–í—ã–±–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–æ–≤</div>
        </button>

        <button class="spawn s2" id="btnKbju" aria-label="–ê–Ω–∫–µ—Ç–∞ –¥–ª—è –ö–ë–ñ–£">
          <div class="icon-wrap"><div class="icon-bg"></div>
            <div class="icon">
              <svg viewBox="0 0 24 24"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
            </div>
          </div>
          <div class="label">–ê–Ω–∫–µ—Ç–∞ –ö–ë–ñ–£</div>
        </button>
      </div>

      <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ 7 –∏–∫–æ–Ω–æ–∫ -->
      <div class="tile" data-module="measurements">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/>
            <path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg></div></div>
        <div class="label">–ó–∞–º–µ—Ä—ã</div>
      </div>

      <div class="tile" data-module="menu">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24">
            <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/>
            <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3z"/><path d="M19 22v-7"/>
          </svg></div></div>
        <div class="label">–†–∞—Ü–∏–æ–Ω</div>
      </div>

      <div class="tile" data-module="diary">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/>
            <line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/>
          </svg></div></div>
        <div class="label">–û—Ç—á—ë—Ç</div>
      </div>

      <div class="tile" data-module="ai">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></div></div>
        <div class="label">AI-–ö–æ—É—á</div>
      </div>

      <div class="tile" data-module="analytics">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg></div></div>
        <div class="label">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
      </div>

      <div class="tile" data-module="profile">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div></div>
        <div class="label">–ü—Ä–æ—Ñ–∏–ª—å</div>
      </div>

      <div class="tile" data-module="subscription">
        <div class="icon-wrap"><div class="icon-bg"></div>
          <div class="icon"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div></div>
        <div class="label">–ü–æ–¥–ø–∏—Å–∫–∞</div>
      </div>
    </div>
  </div>

  <div class="footer">
    <div class="nav active">üè†<span style="font-size:11px">–ì–ª–∞–≤–Ω–∞—è</span></div>
    <div class="nav">üìà<span style="font-size:11px">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span></div>
    <div class="nav">üîî<span style="font-size:11px">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span></div>
    <div class="nav">üë§<span style="font-size:11px">–ü—Ä–æ—Ñ–∏–ª—å</span></div>
  </div>

<div id="toast"></div>

<script>
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  var BLUR_HEADER = false;     // true ‚Äî –±–ª—é—Ä–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏–∏
  var DEMO_PREVIEW = true;     // –≤ –ø—Ä–æ–¥–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å false (–≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã)

  // Telegram API fallback (ES5)
  var tg = (window.Telegram && window.Telegram.WebApp) ? window.Telegram.WebApp : {
    initData:'', initDataUnsafe:{}, ready:function(){}, expand:function(){},
    BackButton:{show:function(){}, hide:function(){}, onClick:function(){}},
    HapticFeedback:{impactOccurred:function(){}}, showAlert:function(m){ alert(m); }
  };
  try { tg.ready(); tg.expand(); } catch(e) {}

  // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  (function(){
    try{
      var u = (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) ? tg.initDataUnsafe.user : null;
      var nameEl=document.getElementById('userName');
      var idEl=document.getElementById('userId');
      var photoEl=document.getElementById('userPhoto');
      if(u){
        var full=((u.first_name||'')+' '+(u.last_name||'')).trim()||'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
        nameEl.textContent=full; idEl.textContent='ID: '+(u.id||'---');
        if(u.photo_url){ var img=new Image(); img.src=u.photo_url; img.alt=full; photoEl.textContent=''; photoEl.appendChild(img); }
        else { photoEl.textContent=(full.charAt(0)||'A').toUpperCase(); }
      }else{
        nameEl.textContent='–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü–µ—Ç—Ä–æ–≤'; idEl.textContent='ID: 123456789'; photoEl.textContent='–ê';
      }
    }catch(e){}
  })();

  // Ripple ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—à—Ç–∞–±
  function ripple(el,e){
    try{
      var r=document.createElement('span'); r.className='r';
      var b=el.getBoundingClientRect();
      r.style.left=(e.clientX-b.left)+'px'; r.style.top=(e.clientY-b.top)+'px';
      el.appendChild(r);
      r.addEventListener('animationend', function(){
        if(r&&r.parentNode){ r.parentNode.removeChild(r); }
      }, false);
    }catch(_){}
  }

  // –¢–æ—Å—Ç (–¥–ª—è –ø—Ä–µ–≤—å—é)
  function toast(msg){
    var t=document.getElementById('toast'); t.textContent=msg; t.style.opacity='1';
    setTimeout(function(){ t.style.opacity='0'; },1600);
  }

  function go(url){
    try{ if(tg.HapticFeedback && tg.HapticFeedback.impactOccurred) tg.HapticFeedback.impactOccurred('medium'); }catch(_){}
    if(DEMO_PREVIEW){ toast('–í –¥–µ–º–æ —Ñ–∞–π–ª—ã –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã. –û—Ç–∫—Ä–æ–µ—Ç—Å—è '+url); return; }
    window.location.href=url;
  }

  // –û—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –≤–µ—Ç–∫—É Start + –±–ª—é—Ä –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
  (function(){
    var grid=document.getElementById('gridB');
    var start=document.getElementById('startB');
    var btnProducts=document.getElementById('btnProducts');
    var btnKbju=document.getElementById('btnKbju');
    var opened=false;
    var backHandler=null;

    function openMenu(){
      if(opened) return;
      opened=true;
      start.classList.add('open-b');
      grid.classList.add('focus');
      if(BLUR_HEADER){ document.body.classList.add('dim-header'); }
      try{
        tg.BackButton.show();
        if(tg.BackButton.onClick){
          backHandler=function(){ closeMenu(); };
          tg.BackButton.onClick(backHandler);
        }
      }catch(_){}
    }

    function closeMenu(){
      if(!opened) return;
      opened=false;
      start.classList.remove('open-b');
      grid.classList.remove('focus');
      document.body.classList.remove('dim-header');
      try{
        tg.BackButton.hide();
        if(backHandler){ tg.BackButton.onClick(function(){}); backHandler=null; }
      }catch(_){}
    }

    start.addEventListener('click', function(e){
      ripple(start,e);
      if(opened) closeMenu(); else openMenu();
    });

    btnProducts.addEventListener('click', function(e){ e.stopPropagation(); go('products.html'); });
    btnKbju.addEventListener('click', function(e){ e.stopPropagation(); go('kbju.html'); });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Esc (–≤ –≤–µ–±–µ)
    document.addEventListener('keydown', function(e){
      if(e.key==='Escape'){ closeMenu(); }
    });
  })();

  // –ó–∞–≥–ª—É—à–∫–∏ –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–∫–æ–Ω–∫–∏
  (function(){
    var tiles=document.querySelectorAll('.tile[data-module]');
    var i;
    for(i=0;i<tiles.length;i++){
      tiles[i].addEventListener('click', function(){ toast('–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ'); });
    }
  })();
</script>
</body>
</html>
