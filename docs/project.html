<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Macros: The Human Operating System</title>
    
    <!-- –ó–∞–≥—Ä—É–∂–∞–µ–º Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- –®—Ä–∏—Ñ—Ç—ã -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Tailwind -->
    <script>
        function initTailwind() {
            if (typeof tailwind === 'undefined') {
                setTimeout(initTailwind, 10);
                return;
            }
            
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: { sans: ['Inter', '-apple-system', 'system-ui', 'sans-serif'] },
                        colors: {
                            core: '#050505',
                            glass: 'rgba(28, 28, 30, 0.65)',
                            'acc-blue': '#0a84ff',
                            'acc-green': '#30d158',
                            'acc-orange': '#ff9f0a',
                            'acc-purple': '#bf5af2',
                            'acc-red': '#ff453a',
                            'acc-pink': '#ff5a8e',
                            'acc-focus': '#5e60ce',
                        },
                        backgroundImage: {
                            'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                        }
                    }
                }
            };
        }
        initTailwind();
    </script>
    
    <style>
        /* === CORE STYLES === */
        :root {
            --bg-core: #050505;
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-highlight: rgba(255, 255, 255, 0.15);
            
            /* üî• –í–ê–ñ–ù–û: –û–±—ä—è–≤–ª—è–µ–º —Ü–≤–µ—Ç–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ CSS */
            --acc-green: #30d158;
            --acc-blue: #0a84ff;
            --acc-orange: #ff9f0a;
            --acc-purple: #bf5af2;
            --acc-pink: #ff5a8e;
        }

        body {
            background-color: var(--bg-core);
            color: #ffffff;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* === ATMOSPHERE === */
        .fx-layer { position: fixed; inset: 0; z-index: -1; pointer-events: none; overflow: hidden; }
        .noise { 
            position: fixed; inset: 0; opacity: 0.04; 
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E"); 
            z-index: 0;
        }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.5; will-change: transform; mix-blend-mode: screen; }
        .orb-1 { width: 80vw; height: 80vw; background: radial-gradient(circle, rgba(10,132,255,0.6) 0%, transparent 70%); top: -20%; left: -20%; animation: float 20s infinite ease-in-out; }
        .orb-2 { width: 60vw; height: 60vw; background: radial-gradient(circle, rgba(191,90,242,0.5) 0%, transparent 70%); bottom: -10%; right: -20%; animation: floatReverse 25s infinite ease-in-out; }

        @keyframes float { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, 50px); } }
        @keyframes floatReverse { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(-30px, -50px); } }

        /* === UI COMPONENTS === */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-top: 1px solid var(--glass-highlight);
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
        }

        /* Typography */
        .hero-title {
            background: linear-gradient(180deg, #FFFFFF 0%, rgba(255,255,255,0.5) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.04em;
            line-height: 0.95;
        }
        
        .eyebrow {
            font-size: 11px; font-weight: 800; letter-spacing: 0.2em; text-transform: uppercase;
        }

        /* === ANIMATIONS === */
        .reveal { opacity: 0; transform: translateY(40px) scale(0.95); transition: all 1s cubic-bezier(0.16, 1, 0.3, 1); }
        .reveal.active { opacity: 1; transform: translateY(0) scale(1); }
        .delay-100 { transition-delay: 100ms; }
        .delay-200 { transition-delay: 200ms; }
        .delay-300 { transition-delay: 300ms; }

        /* === WIDGETS === */
        /* SCANNER UI */
        .scan-frame { position: relative; width: 100%; height: 100%; border-radius: 20px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
        .scan-line { position: absolute; top: 0; left: 0; right: 0; height: 2px; background: #30d158; box-shadow: 0 0 15px #30d158; animation: scanMove 3s infinite ease-in-out; z-index: 10; }
        @keyframes scanMove { 0%, 100% { transform: translateY(20%); opacity: 0; } 50% { transform: translateY(300px); opacity: 1; } }
        
        .scan-tag { 
            position: absolute; padding: 6px 10px; background: rgba(0,0,0,0.6); backdrop-filter: blur(10px); 
            border: 1px solid rgba(48, 209, 88, 0.3); border-radius: 8px; color: #fff; font-size: 11px; font-weight: 600;
            display: flex; gap: 6px; align-items: center; opacity: 0; animation: tagPop 3s infinite; z-index: 20;
        }
        .scan-tag.t1 { top: 30%; left: 20%; animation-delay: 1s; }
        .scan-tag.t2 { top: 60%; right: 20%; animation-delay: 1.5s; }
        @keyframes tagPop { 0%, 90%, 100% { opacity: 0; transform: scale(0.9); } 20%, 80% { opacity: 1; transform: scale(1); } }

        /* Deconstruction */
        .deconstruct-layer {
            position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
            background: linear-gradient(45deg, transparent 40%, rgba(48, 209, 88, 0.1) 45%, rgba(48, 209, 88, 0.3) 50%, rgba(48, 209, 88, 0.1) 55%, transparent 60%);
            background-size: 200% 200%;
            animation: deconstruct 3s infinite linear;
            mix-blend-mode: overlay;
        }
        @keyframes deconstruct { 0% { background-position: 100% 100%; } 100% { background-position: 0% 0%; } }

        /* BLUEPRINT GRID */
        .blueprint-grid {
            background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            mask-image: radial-gradient(circle, black 40%, transparent 80%);
        }

        /* --- ACCURACY CHART --- */
        @keyframes gray-pulse {
            0% { opacity: 0.3; stroke-width: 6; }
            50% { opacity: 0.6; stroke-width: 7; }
            100% { opacity: 0.3; stroke-width: 6; }
        }

        .accuracy-chart {
            width: 180px; height: 180px; position: relative;
            display: flex; align-items: center; justify-content: center;
        }
        .accuracy-chart svg { 
            width: 100%; height: 100%; transform: rotate(-90deg); 
        }
        .accuracy-chart circle { 
            fill: none; stroke-width: 6; stroke-linecap: round; cx: 90; cy: 90; r: 80;
        }
        .accuracy-chart .bg { 
            stroke: rgba(255,255,255,0.15); stroke-dasharray: 502; stroke-dashoffset: 0; 
            animation: gray-pulse 3s infinite ease-in-out;
        }
        .accuracy-chart .progress { 
            stroke: var(--acc-green); stroke-dasharray: 502; stroke-dashoffset: 502; 
            filter: drop-shadow(0 0 8px rgba(48, 209, 88, 0.6));
            transition: none; 
        }
        .accuracy-chart .value {
            position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;
        }

        /* VITRUVIAN TOGGLE */
        .vitruvian-toggle {
            display: flex; background: rgba(255,255,255,0.1); border-radius: 20px; padding: 4px;
        }
        .vitruvian-toggle button {
            flex: 1; padding: 10px 16px; border-radius: 16px; font-size: 13px; font-weight: 600; color: rgba(255,255,255,0.6); transition: all 0.3s;
        }
        .vitruvian-toggle button.active {
            background: var(--acc-purple); color: white; box-shadow: 0 2px 10px rgba(191,90,242,0.3);
        }

        /* === BREATH VISUALIZER STYLES === */
        .breath-wrapper {
            width: 100%; height: 360px;
            display: flex; align-items: center; justify-content: center;
            position: relative; overflow: hidden;
        }
        .breath-bubble {
            width: 140px; height: 140px; border-radius: 50%;
            background: radial-gradient(circle, var(--breath-color, #0a84ff) 0%, transparent 70%);
            box-shadow: 0 0 40px var(--breath-glow, rgba(10,132,255,0.4));
            position: relative; will-change: transform, opacity; transform: scale(1);
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }
        .breath-bubble::after {
            content: ''; position: absolute; inset: -10px; border-radius: 50%;
            border: 1px solid var(--breath-color, #0a84ff); opacity: 0.3; transform: scale(0.9);
            animation: bubbleRipple 4s infinite ease-out;
        }
        @keyframes bubbleRipple {
            0% { transform: scale(0.9); opacity: 0.4; } 100% { transform: scale(1.8); opacity: 0; }
        }
        .breath-status {
            position: absolute; top: 40px; left: 0; right: 0; text-align: center;
            font-size: 14px; font-weight: 700; letter-spacing: 0.2em; text-transform: uppercase;
            text-shadow: 0 0 10px currentColor; opacity: 0; transition: opacity 0.3s; z-index: 20;
            color: var(--breath-color, #0a84ff);
        }
        .breath-status.visible { opacity: 1; }
        .breath-title-lbl {
            position: absolute; bottom: 40px; left: 0; right: 0; text-align: center;
            font-size: 12px; font-weight: 500; letter-spacing: 0.1em; opacity: 0.5; z-index: 20;
        }
        .breath-btn { cursor: pointer; transition: all 0.2s; }
        .breath-btn:hover { background: rgba(255,255,255,0.05); }
        .breath-btn.active { background: rgba(255,255,255,0.1); }

        /* === SYNC ANIMATIONS === */
        @keyframes float-up-fade {
            0% { opacity: 0; transform: translateY(15px) scale(0.95); }
            20% { opacity: 1; transform: translateY(0) scale(1); }
            80% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-15px) scale(0.95); }
        }
        .sync-bubble-anim { animation: float-up-fade 4s infinite ease-in-out; }
        
    </style>
</head>
<body class="antialiased">

    <div class="fx-layer">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="noise"></div>
    </div>

    <!-- === HERO === -->
    <section class="min-h-screen relative flex flex-col justify-center px-6 pt-12 pb-32">
        <div class="max-w-md mx-auto w-full relative z-10 text-center">
            
            <div class="reveal active delay-100">
                <div class="eyebrow text-acc-blue mb-6 border border-acc-blue/20 bg-acc-blue/10 inline-block px-3 py-1 rounded-full">
                    The Human Operating System
                </div>
                <h1 class="hero-title text-5xl md:text-6xl font-black mb-6 uppercase">
                    –¢–≤–æ—ë —Ç–µ–ª–æ <br>
                    <span class="text-white/40">—ç—Ç–æ –¥–∞–Ω–Ω—ã–µ</span>
                </h1>
                <p class="text-white/60 text-lg leading-relaxed font-light">
                    –ü–µ—Ä–≤–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ—Ä—è–µ—Ç, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∞—à–∏–º –º–µ—Ç–∞–±–æ–ª–∏–∑–º–æ–º —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.
                </p>
            </div>
            
        </div>
    </section>

    <!-- === PHILOSOPHY === -->
    <section class="py-24 px-6 relative">
        <div class="max-w-lg mx-auto w-full">
            <div class="reveal">
                <div class="eyebrow text-acc-blue mb-4">Precision Nutrition</div>
                <h2 class="text-3xl font-bold mb-6 leading-tight uppercase">–ù–µ–ª—å–∑—è —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–º,<br><span class="text-white/40">—á—Ç–æ –Ω–µ–ª—å–∑—è –∏–∑–º–µ—Ä–∏—Ç—å.</span></h2>
                <p class="text-white/70 mb-8 leading-relaxed">
                    –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç—Ä–µ–∫–µ—Ä–æ–≤ –≥–∞–¥–∞—é—Ç. Macros —Å—á–∏—Ç–∞–µ—Ç. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è, —Å—Ç—Ä–æ—è—â—É—é –º–æ–¥–µ–ª—å –≤–∞—à–µ–≥–æ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ 20+ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
                </p>
            </div>

            <!-- Glass Card -->
            <div class="glass-panel rounded-[28px] p-6 reveal delay-100 space-y-6">
                <div class="flex gap-4 items-start">
                    <div class="w-10 h-10 rounded-xl bg-acc-blue/10 flex items-center justify-center text-xl shrink-0">üî•</div>
                    <div>
                        <h3 class="font-bold text-white text-sm mb-1">PAL & NEAT</h3>
                        <p class="text-xs text-white/50 leading-relaxed">–ú—ã —É—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –∞ –≤–∞—à—É –≤–Ω–µ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (Non-Exercise Activity Thermogenesis).</p>
                    </div>
                </div>
                <div class="w-full h-[1px] bg-white/5"></div>
                <div class="flex gap-4 items-start">
                    <div class="w-10 h-10 rounded-xl bg-acc-green/10 flex items-center justify-center text-xl shrink-0">üß¨</div>
                    <div>
                        <h3 class="font-bold text-white text-sm mb-1">–ì–ª—É–±–æ–∫–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è</h3>
                        <p class="text-xs text-white/50 leading-relaxed">–†–∞—Å—á–µ—Ç –Ω–æ—Ä–º—ã –±–µ–ª–∫–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –≤–∞—à–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ (MET) –∏ —Ñ–∞–∑—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.</p>
                    </div>
                </div>
                <div class="w-full h-[1px] bg-white/5"></div>
                <div class="flex gap-4 items-start">
                    <div class="w-10 h-10 rounded-xl bg-acc-purple/10 flex items-center justify-center text-xl shrink-0">ü©∫</div>
                    <div>
                        <h3 class="font-bold text-white text-sm mb-1">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç</h3>
                        <p class="text-xs text-white/50 leading-relaxed">–ê–ª–≥–æ—Ä–∏—Ç–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –Ω—É—Ç—Ä–∏–µ–Ω—Ç—ã –ø–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- === RATION === -->
    <section class="py-24 px-6 border-t border-white/5 bg-white/[0.02]">
        <div class="max-w-lg mx-auto w-full reveal" id="chart-section">
            <div class="eyebrow text-acc-green mb-4">Computed Nutrition</div>
            <h2 class="text-3xl font-bold mb-6 uppercase">–í–∞–º –Ω–µ –Ω—É–∂–Ω—ã –¥–∏–µ—Ç—ã. <br><span class="text-acc-green">–í–∞–º –Ω—É–∂–Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞.</span></h2>
            <p class="text-white/60 mb-12 leading-relaxed">
                –í—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã. –°–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–æ–∏—Ç –Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –≥—Ä–∞–º–º–∞. Zero waste ‚Äî –≤—ã –ø–æ–∫—É–ø–∞–µ—Ç–µ —Ä–æ–≤–Ω–æ —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ.
            </p>
            
            <div class="flex flex-col items-center justify-center mb-10 relative w-full">
                <div class="absolute inset-0 bg-acc-green/5 blur-3xl rounded-full"></div>
                <div class="glass-panel p-10 rounded-[48px] relative z-10 flex flex-col items-center">
                    <div class="accuracy-chart mb-2">
                        <svg viewBox="0 0 180 180">
                            <circle class="bg" />
                            <circle class="progress" id="acc-circle" />
                        </svg>
                        <div class="value">
                            <div class="flex items-baseline">
                                <span class="text-5xl font-black tracking-tighter tabular-nums" id="accuracy-val">0.0</span>
                                <span class="text-2xl font-bold text-acc-green ml-1">%</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-[10px] uppercase tracking-[0.2em] text-acc-green font-bold mt-4 opacity-80">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                </div>
            </div>

            <p class="text-lg font-medium text-white/90 italic max-w-sm mx-auto text-center">"–ú—ã —É–±—Ä–∞–ª–∏ –≤–æ–ø—Ä–æ—Å '–ß—Ç–æ –º–Ω–µ —Å–µ–≥–æ–¥–Ω—è –ø–æ–µ—Å—Ç—å?'. –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Å–ª–µ–¥—É–π—Ç–µ –ø–ª–∞–Ω—É."</p>
        </div>
    </section>

    <!-- === TECHNOLOGIES === -->
    <section class="py-24 px-6 overflow-hidden">
        <div class="max-w-lg mx-auto w-full">
            <div class="reveal mb-12">
                <div class="eyebrow text-acc-orange mb-4">Visual Intelligence</div>
                <h2 class="text-3xl font-bold mb-6 uppercase">–ù–µ–π—Ä–æ—Å–µ—Ç—å –≤–º–µ—Å—Ç–æ <br><span class="text-white/40">—Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞.</span></h2>
                <p class="text-white/60 mb-6">–†—É—á–Ω–æ–π –ø–æ–¥—Å—á–µ—Ç ‚Äî —ç—Ç–æ –∞—Ä—Ö–∞–∏–∑–º. –ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É. –°–∏—Å—Ç–µ–º–∞ –∞–≥–µ–Ω—Ç–æ–≤ Macros FoodCam –¥–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ—Ç –≤–∞—à—É –µ–¥—É:</p>
            </div>

            <div class="relative w-full aspect-[4/5] bg-black rounded-[32px] border border-white/10 shadow-2xl reveal delay-100 overflow-hidden group">
                <div class="absolute inset-0 bg-gray-900">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-orange-500/30 rounded-full blur-xl"></div>
                    <div class="absolute bottom-1/4 right-1/4 w-24 h-24 bg-green-500/20 rounded-full blur-xl"></div>
                </div>
                <div class="deconstruct-layer"></div>
                <div class="absolute inset-4 border border-white/20 rounded-xl z-10 pointer-events-none">
                    <div class="absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-white"></div>
                    <div class="absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-white"></div>
                    <div class="absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-white"></div>
                    <div class="absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-white"></div>
                </div>
                <div class="scan-line"></div>
                <div class="scan-tag t1 bg-black/80"><span class="w-2 h-2 rounded-full bg-acc-green"></span>–ê–≤–æ–∫–∞–¥–æ-—Ç–æ—Å—Ç</div>
                <div class="scan-tag t2 bg-black/80"><span class="w-2 h-2 rounded-full bg-acc-orange"></span>–Ø–π—Ü–æ (L)</div>
                <div class="absolute bottom-0 inset-x-0 p-6 bg-gradient-to-t from-black to-transparent z-20 flex flex-col items-center pointer-events-none">
                    <div class="w-16 h-16 rounded-full border-4 border-white/20 flex items-center justify-center mb-4">
                        <div class="w-12 h-12 bg-white rounded-full"></div>
                    </div>
                    <div class="text-[10px] text-white/50 uppercase tracking-widest">–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...</div>
                </div>
            </div>

            <div class="mt-12 space-y-4 reveal delay-200">
                <div class="glass-panel p-4 rounded-xl flex items-center gap-4">
                    <span class="text-xs font-bold text-white uppercase w-20 shrink-0">Gatekeeper</span>
                    <span class="text-xs text-white/50">–û—Ç—Å–µ–∫–∞–µ—Ç —Ñ–æ–Ω –∏ –Ω–µ—Å—ä–µ–¥–æ–±–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.</span>
                </div>
                <div class="glass-panel p-4 rounded-xl flex items-center gap-4">
                    <span class="text-xs font-bold text-white uppercase w-20 shrink-0">Physicist</span>
                    <span class="text-xs text-white/50">–°—Ç—Ä–æ–∏—Ç 3D-–∫–∞—Ä—Ç—É –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Å–∞.</span>
                </div>
                <div class="glass-panel p-4 rounded-xl flex items-center gap-4">
                    <span class="text-xs font-bold text-white uppercase w-20 shrink-0">Synthesizer</span>
                    <span class="text-xs text-white/50">–†–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –±–ª—é–¥–æ –Ω–∞ –º–æ–ª–µ–∫—É–ª—ã (–ë–ñ–£).</span>
                </div>
                <p class="text-xs text-white/30 italic pl-2 border-l border-white/20 mt-4">
                    –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ ¬´—Ç–≤–æ—Ä–æ–≥ –∏ —è–±–ª–æ–∫–æ¬ª –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ FatSecret.
                </p>
            </div>
        </div>
    </section>

    <!-- === BODY ARCHITECTURE (VITRUVIAN) === -->
    <section class="py-24 px-6 relative" id="vitruvian-section">
        <div class="max-w-lg mx-auto w-full reveal">
            <div class="eyebrow text-acc-purple mb-4">Genetic Potential</div>
            <h2 class="text-3xl font-bold mb-6 uppercase">–í–∞—à–∞ –≥–µ–Ω–µ—Ç–∏–∫–∞ ‚Äî <br><span class="text-white/40">—ç—Ç–æ —á–µ—Ä—Ç–µ–∂.</span></h2>
            <p class="text-white font-medium mb-4">–ú–´ –ü–û–ú–û–ñ–ï–ú –ü–û–°–¢–†–û–ò–¢–¨ –ò–î–ï–ê–õ–¨–ù–û–ï –¢–ï–õ–û.</p>
            <p class="text-white/60 mb-8">
                –ú—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–∞—à –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (FFMI) –∏ —Å—Ç—Ä–æ–∏–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–π.
            </p>

            <div class="glass-panel rounded-2xl flex mb-8 w-full max-w-sm mx-auto vitruvian-toggle">
                <button class="active" data-type="man">–ú—É–∂—á–∏–Ω–∞ (V-Shape)</button>
                <button data-type="woman">–ñ–µ–Ω—â–∏–Ω–∞ (X-Shape)</button>
            </div>

            <div class="glass-panel rounded-[32px] aspect-square relative flex items-center justify-center overflow-hidden mb-8">
                <div class="absolute inset-0 blueprint-grid opacity-30"></div>
                <!-- Man -->
                <svg id="vitruvian-man" class="absolute inset-0 w-full h-full p-8 transition-all duration-500 ease-in-out opacity-100 scale-100 drop-shadow-[0_0_15px_rgba(191,90,242,0.5)]" viewBox="0 0 200 300" fill="none">
                    <circle cx="100" cy="150" r="90" stroke="rgba(255,255,255,0.2)" stroke-width="1" stroke-dasharray="4 4"/>
                    <rect x="30" y="40" width="140" height="220" stroke="rgba(255,255,255,0.2)" stroke-width="1" stroke-dasharray="4 4"/>
                    <path d="M100 60 L150 100 L130 200 L100 240 L70 200 L50 100 Z" stroke="white" stroke-width="1.5" fill="rgba(191,90,242,0.1)"/>
                    <line x1="100" y1="60" x2="100" y2="240" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                    <path d="M60 100 L140 100" stroke="#bf5af2" stroke-width="3" stroke-linecap="round" class="animate-pulse"/>
                    <circle cx="100" cy="60" r="3" fill="#bf5af2"/>
                    <circle cx="150" cy="100" r="3" fill="#bf5af2"/>
                    <circle cx="50" cy="100" r="3" fill="#bf5af2"/>
                    <text x="160" y="90" fill="#bf5af2" font-size="10" font-family="monospace">DELTS</text>
                </svg>
                <!-- Woman -->
                <svg id="vitruvian-woman" class="absolute inset-0 w-full h-full p-8 transition-all duration-500 ease-in-out opacity-0 scale-95 drop-shadow-[0_0_15px_rgba(255,90,142,0.5)]" viewBox="0 0 200 300" fill="none">
                    <circle cx="100" cy="150" r="90" stroke="rgba(255,255,255,0.2)" stroke-width="1" stroke-dasharray="4 4"/>
                    <rect x="30" y="40" width="140" height="220" stroke="rgba(255,255,255,0.2)" stroke-width="1" stroke-dasharray="4 4"/>
                    <path d="M100 70 L140 110 L120 160 L140 210 L100 250 L60 210 L80 160 L60 110 Z" stroke="white" stroke-width="1.5" fill="rgba(255,90,142,0.1)"/>
                    <line x1="100" y1="70" x2="100" y2="250" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                     <path d="M80 160 L120 160" stroke="#ff5a8e" stroke-width="3" stroke-linecap="round" class="animate-pulse"/>
                     <path d="M60 210 L140 210" stroke="#ff5a8e" stroke-width="3" stroke-linecap="round" class="animate-pulse" style="animation-delay: 0.5s;"/>
                    <circle cx="100" cy="70" r="3" fill="#ff5a8e"/>
                    <circle cx="140" cy="110" r="3" fill="#ff5a8e"/>
                    <circle cx="60" cy="110" r="3" fill="#ff5a8e"/>
                    <circle cx="140" cy="210" r="3" fill="#ff5a8e"/>
                    <circle cx="60" cy="210" r="3" fill="#ff5a8e"/>
                     <text x="150" y="200" fill="#ff5a8e" font-size="10" font-family="monospace">GLUTES</text>
                </svg>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="p-4 bg-white/5 rounded-2xl border border-white/5 flex flex-col justify-between">
                    <div class="text-xs text-white/50 mb-2">–ê–Ω–∞–ª–∏–∑ –ú–æ–¥–µ–ª–∏</div>
                    <div id="vitruvian-shape-label" class="font-bold text-sm text-acc-purple transition-colors leading-tight">V-Shape –ú–æ–¥–µ–ª—å</div>
                    <div class="mt-2 text-[10px] text-white/40 leading-snug">
                        –†–∞—Å—á–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–ø—è—Å—Ç—å—è –∏ –ª–æ–¥—ã–∂–∫–∏.
                    </div>
                </div>
                <div class="p-4 bg-white/5 rounded-2xl border border-white/5 flex flex-col relative overflow-hidden group min-h-[100px]">
                    <div class="text-xs text-white/50 mb-3 z-10 relative">–ö–æ–Ω—Ç—Ä–æ–ª—å (Plan/Fact)</div>
                    <div id="pf-man" class="space-y-3 transition-all duration-500">
                        <div>
                            <div class="flex justify-between text-[10px] uppercase font-bold mb-1 tracking-wider">
                                <span class="text-white/70">V-Index</span>
                                <span class="text-acc-purple">1.42 <span class="text-white/30">/ 1.618</span></span>
                            </div>
                            <div class="h-1.5 w-full bg-white/10 rounded-full relative overflow-hidden">
                                <div class="absolute inset-y-0 left-0 bg-acc-purple rounded-full shadow-[0_0_10px_#bf5af2]" style="width: 88%"></div>
                                <div class="absolute top-0 bottom-0 w-0.5 bg-white z-10 opacity-80" style="left: 98%"></div> 
                            </div>
                        </div>
                        <div>
                             <div class="flex justify-between text-[10px] uppercase font-bold mb-1 tracking-wider">
                                <span class="text-white/70">FFMI</span>
                                <span class="text-acc-purple">22 <span class="text-white/30">/ 25</span></span>
                            </div>
                            <div class="h-1.5 w-full bg-white/10 rounded-full relative overflow-hidden">
                                 <div class="absolute inset-y-0 left-0 bg-acc-purple rounded-full opacity-60" style="width: 88%"></div>
                            </div>
                        </div>
                    </div>
                    <div id="pf-woman" class="space-y-3 transition-all duration-500 absolute inset-0 p-4 pt-8 opacity-0 pointer-events-none translate-x-8">
                        <div>
                            <div class="flex justify-between text-[10px] uppercase font-bold mb-1 tracking-wider">
                                <span class="text-white/70">W/H Ratio</span>
                                <span class="text-acc-pink">0.76 <span class="text-white/30">/ 0.70</span></span>
                            </div>
                            <div class="h-1.5 w-full bg-white/10 rounded-full relative overflow-hidden">
                                <div class="absolute inset-y-0 left-0 bg-acc-pink rounded-full shadow-[0_0_10px_#ff5a8e]" style="width: 90%"></div>
                                <div class="absolute top-0 bottom-0 w-0.5 bg-white z-10 opacity-80" style="left: 100%"></div>
                            </div>
                        </div>
                        <div>
                             <div class="flex justify-between text-[10px] uppercase font-bold mb-1 tracking-wider">
                                <span class="text-white/70">Body Fat</span>
                                <span class="text-acc-pink">22% <span class="text-white/30">/ 18%</span></span>
                            </div>
                            <div class="h-1.5 w-full bg-white/10 rounded-full relative overflow-hidden">
                                 <div class="absolute inset-y-0 left-0 bg-acc-pink rounded-full opacity-60" style="width: 82%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- === SYNC (FIXED: PERFECTLY CENTERED LINES) === -->
    <section class="py-24 px-6 border-t border-white/5 bg-white/[0.02]" id="sync-section">
        <div class="max-w-lg mx-auto w-full reveal">
            <div class="eyebrow text-acc-blue mb-4">The Infinite Loop</div>
            <h2 class="text-3xl font-bold mb-6 uppercase">–°–≤—è–∑—å –Ω–∞ —É—Ä–æ–≤–Ω–µ <br><span class="text-white/40">–¥–∞–Ω–Ω—ã—Ö.</span></h2>
            
            <p class="text-white/60 mb-8 leading-relaxed">
                –ù–∏–∫–∞–∫–∏—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –¥–Ω–µ–≤–Ω–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è. –ù–∏–∫–∞–∫–∏—Ö —Ñ–æ—Ç–æ –≤–µ—Å–æ–≤. –í–∞—à —Ç—Ä–µ–Ω–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í—ã –∑–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å —Ç–µ–ª–æ–º, —Å–∏—Å—Ç–µ–º–∞ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π.
            </p>

            <!-- SYNC WIDGET -->
            <div class="glass-panel rounded-[32px] p-0 relative overflow-hidden mb-8 h-[240px] flex items-center justify-center">
                <div class="absolute inset-0 blueprint-grid opacity-20"></div>
                
                <!-- NODES LAYER -->
                <div class="relative w-full h-full flex justify-between items-center px-8 z-10">
                    
                    <!-- USER NODE (Left) -->
                    <div class="flex flex-col items-center relative group z-20">
                        <div class="w-16 h-16 rounded-full bg-white/5 border border-white/10 flex items-center justify-center backdrop-blur-md shadow-[0_0_30px_rgba(48,209,88,0.2)] transition-all duration-500 group-hover:scale-110">
                            <div class="text-2xl">üë§</div>
                        </div>
                        <div class="mt-3 text-[10px] uppercase tracking-widest text-white/50 font-bold">–í—ã</div>
                        
                        <div class="absolute -top-8 right-0 bg-acc-green/20 border border-acc-green/30 text-acc-green text-[9px] px-2 py-1 rounded-full opacity-0 sync-bubble-anim">
                            –ö–ë–ñ–£ 100%
                        </div>
                         <div class="absolute -bottom-6 left-0 bg-acc-green/20 border border-acc-green/30 text-acc-green text-[9px] px-2 py-1 rounded-full opacity-0 sync-bubble-anim" style="animation-delay: 1.5s;">
                            –í–µ—Å -0.5–∫–≥
                        </div>
                    </div>

                    <!-- CONNECTION LAYER (Middle) -->
                    <div class="flex-1 h-full relative z-0 mx-4"> 
                        <!-- SVG —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–≤ -->
                        <svg class="absolute top-0 bottom-0 -left-12 -right-12 w-[calc(100%+6rem)] h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                            
                            <!-- Line 1: User to Trainer (Green) - Y=45 (Straight) -->
                            <line x1="0" y1="45" x2="100" y2="45" stroke="rgba(255,255,255,0.1)" stroke-width="1" vector-effect="non-scaling-stroke" />
                            
                            <!-- Line 2: Trainer to User (Blue) - Y=55 (Straight) -->
                            <line x1="100" y1="55" x2="0" y2="55" stroke="rgba(255,255,255,0.1)" stroke-width="1" vector-effect="non-scaling-stroke" />
                            
                            <!-- Particles (Straight path) -->
                            <circle r="3" fill="#30d158" style="filter: drop-shadow(0 0 5px #30d158);">
                                <animateMotion dur="2.5s" repeatCount="indefinite">
                                    <mpath xlink:href="#path1" /> 
                                    <!-- Fallback if mpath fails in some browsers, use path attr directly -->
                                    <path d="M 0 45 L 100 45" /> 
                                </animateMotion>
                            </circle>
                            <circle r="3" fill="#0a84ff" style="filter: drop-shadow(0 0 5px #0a84ff);">
                                <animateMotion dur="3s" repeatCount="indefinite">
                                    <path d="M 100 55 L 0 55" />
                                </animateMotion>
                            </circle>
                        </svg>
                    </div>

                    <!-- TRAINER NODE (Right) -->
                    <div class="flex flex-col items-center relative group z-20">
                        <div class="w-16 h-16 rounded-full bg-white/5 border border-white/10 flex items-center justify-center backdrop-blur-md shadow-[0_0_30px_rgba(10,132,255,0.2)] transition-all duration-500 group-hover:scale-110">
                            <div class="text-2xl">üë®‚Äçüíª</div>
                        </div>
                        <div class="mt-3 text-[10px] uppercase tracking-widest text-white/50 font-bold">–¢—Ä–µ–Ω–µ—Ä</div>
                        
                        <div class="absolute -top-6 left-0 bg-acc-blue/20 border border-acc-blue/30 text-acc-blue text-[9px] px-2 py-1 rounded-full opacity-0 sync-bubble-anim" style="animation-delay: 0.8s;">
                            –ü–ª–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- Features List -->
            <div class="space-y-4">
                <div class="flex gap-4 items-start">
                    <div class="w-8 h-8 rounded-full bg-acc-green/10 flex items-center justify-center text-xs shrink-0 mt-1">üì°</div>
                    <div>
                        <h4 class="font-bold text-white text-sm mb-1">–ê–≤—Ç–æ-—Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è</h4>
                        <p class="text-xs text-white/50 leading-relaxed">–°–æ–±–ª—é–¥–µ–Ω–∏–µ –ö–ë–ñ–£ –∏ –∑–∞–º–µ—Ä—ã —Ç–µ–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –¢—Ä–µ–Ω–µ—Ä –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç–∏–Ω—É —Ü–µ–ª–∏–∫–æ–º.</p>
                    </div>
                </div>
                <div class="w-full h-[1px] bg-white/5"></div>
                <div class="flex gap-4 items-start">
                    <div class="w-8 h-8 rounded-full bg-acc-blue/10 flex items-center justify-center text-xs shrink-0 mt-1">üìÖ</div>
                    <div>
                        <h4 class="font-bold text-white text-sm mb-1">–û–±—â–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h4>
                        <p class="text-xs text-white/50 leading-relaxed">–¢—Ä–µ–Ω–µ—Ä –º–µ–Ω—è–µ—Ç –≤—Ä–µ–º—è ‚Äî –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –í—ã –æ—Ç–º–µ–Ω—è–µ—Ç–µ —Å–ª–æ—Ç ‚Äî —Ç—Ä–µ–Ω–µ—Ä –≤–∏–¥–∏—Ç —ç—Ç–æ —Å—Ä–∞–∑—É.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- === STATE (BREATH) === -->
    <section class="py-24 px-6" id="breath-section">
        <div class="max-w-lg mx-auto w-full reveal">
            <div class="eyebrow text-acc-blue mb-4">Neuro-Regulation</div>
            <h2 class="text-3xl font-bold mb-6 uppercase">–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å <br><span class="text-white/40">—Å—Ç—Ä–µ—Å—Å–∞.</span></h2>
            <p class="text-white/60 mb-10">
                –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è. –ú–æ–¥—É–ª—å Macros Breath –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –Ω–µ–π—Ä–æ–±–∏–æ–ª–æ–≥–æ–≤ Stanford Huberman Lab.
            </p>

            <!-- Breath Widget -->
            <div class="glass-panel rounded-[32px] p-8 flex flex-col items-center justify-center mb-10 relative overflow-hidden min-h-[360px] breath-wrapper">
                <div class="absolute inset-0 bg-gradient-to-b from-acc-blue/5 to-transparent opacity-20 transition-colors duration-700" id="breath-bg"></div>
                
                <div class="breath-status text-acc-blue mb-4" id="breath-status-lbl">–í–î–û–•</div>
                <div class="breath-bubble" id="breath-bubble"></div>
                <div class="breath-title-lbl" id="breath-title"></div>
            </div>

            <div class="space-y-4">
                <div class="breath-btn flex justify-between items-center border-b border-white/10 pb-3 p-2 rounded-xl" id="btn-focus" onclick="startBreath('focus')">
                    <span class="font-bold text-acc-focus" style="color:#5e60ce">Focus</span>
                    <span class="text-xs text-white/50 text-right">–ö–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ<br>–¥–ª—è –ø–æ—Ç–æ–∫–∞</span>
                </div>
                <div class="breath-btn flex justify-between items-center border-b border-white/10 pb-3 p-2 rounded-xl" id="btn-sleep" onclick="startBreath('sleep')">
                    <span class="font-bold text-acc-orange">Sleep</span>
                    <span class="text-xs text-white/50 text-right">–ü—Ä–æ—Ç–æ–∫–æ–ª 4-7-8<br>–¥–ª—è —Ç–æ—Ä–º–æ–∂–µ–Ω–∏—è –∫–æ—Ä—ã</span>
                </div>
                <div class="breath-btn flex justify-between items-center pb-3 p-2 rounded-xl" id="btn-stress" onclick="startBreath('stress')">
                    <span class="font-bold text-acc-blue" style="color:#4facfe">Anti-Stress</span>
                    <span class="text-xs text-white/50 text-right">–§–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –≤–∑–¥–æ—Ö<br>—Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ—Ä—Ç–∏–∑–æ–ª–∞</span>
                </div>
            </div>
        </div>
    </section>

    <!-- === FOOTER === -->
    <footer class="py-24 px-6 text-center border-t border-white/10 relative overflow-hidden bg-white/[0.02]">
        <div class="max-w-lg mx-auto w-full relative z-10 reveal">
            <h2 class="text-2xl font-bold mb-4 leading-tight">Macros ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ñ–∏—Ç–Ω–µ—Å–∞.</h2>
            <p class="text-xl text-white/50 font-light mb-12">–≠—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤–∞—à–µ–≥–æ —Ç–µ–ª–∞.</p>
            
            <div class="mt-12 text-[10px] text-white/20 uppercase tracking-[0.2em] space-x-4">
                <span>Privacy</span>
                <span>Terms</span>
                <span>2025</span>
            </div>
        </div>
    </footer>

    <script>
        // === ANIMATE VALUE FUNCTION ===
        function animateValue(obj, start, end, duration) {
            if (!obj) return;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                const val = (progress * (end - start) + start).toFixed(1);
                obj.innerHTML = val;
                if (progress < 1) window.requestAnimationFrame(step); else obj.innerHTML = end;
            };
            window.requestAnimationFrame(step);
        }

        // === CHART & NUMBER LOOP LOGIC ===
        function startAccuracyLoop(valEl, circleEl) {
            const maxVal = 99.8;
            const fullDash = 502; 
            const phases = { grow: 4000, holdHigh: 2000, shrink: 4000, holdLow: 1000 };
            const totalDuration = phases.grow + phases.holdHigh + phases.shrink + phases.holdLow;
            
            const animate = (time) => {
                const cycleTime = time % totalDuration;
                let progress = 0;
                
                if (cycleTime < phases.grow) {
                    const t = cycleTime / phases.grow;
                    progress = 1 - Math.pow(1 - t, 3);
                } else if (cycleTime < (phases.grow + phases.holdHigh)) {
                    progress = 1;
                } else if (cycleTime < (phases.grow + phases.holdHigh + phases.shrink)) {
                    const t = (cycleTime - phases.grow - phases.holdHigh) / phases.shrink;
                    progress = Math.pow(1 - t, 3);
                } else {
                    progress = 0;
                }
                
                const currentVal = (progress * maxVal).toFixed(1);
                if(valEl) valEl.innerHTML = currentVal;
                const offset = fullDash - (progress * fullDash);
                if(circleEl) circleEl.style.strokeDashoffset = offset;
                
                requestAnimationFrame(animate);
            };
            requestAnimationFrame(animate);
        }

        // Scroll Reveal logic
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    if (entry.target.id === 'chart-section') {
                        const valEl = document.getElementById('accuracy-val');
                        const circleEl = document.getElementById('acc-circle');
                        if (!valEl.dataset.started) {
                            startAccuracyLoop(valEl, circleEl);
                            valEl.dataset.started = 'true';
                        }
                    }
                    if (entry.target.querySelector('#breath-bg')) {
                       if (typeof isBreathing !== 'undefined' && !isBreathing) {
                           startBreath('focus');
                       }
                    }
                }
            });
        }, { threshold: 0.1 }); 

        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

        // Vitruvian Toggle
        const vitruvianSection = document.getElementById('vitruvian-section');
        const btns = vitruvianSection.querySelectorAll('.vitruvian-toggle button');
        const manSvg = document.getElementById('vitruvian-man');
        const womanSvg = document.getElementById('vitruvian-woman');
        const shapeLabel = document.getElementById('vitruvian-shape-label');
        const pfMan = document.getElementById('pf-man');
        const pfWoman = document.getElementById('pf-woman');

        btns.forEach(btn => {
            btn.addEventListener('click', () => {
                btns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                const type = btn.dataset.type;

                if (type === 'man') {
                    manSvg.style.opacity = '1'; manSvg.style.transform = 'scale(1)';
                    womanSvg.style.opacity = '0'; womanSvg.style.transform = 'scale(0.95)';
                    shapeLabel.textContent = 'V-Shape –ú–æ–¥–µ–ª—å';
                    shapeLabel.classList.remove('text-acc-pink'); shapeLabel.classList.add('text-acc-purple');
                    pfMan.classList.remove('opacity-0', 'pointer-events-none', 'translate-x-8'); 
                    pfWoman.classList.add('opacity-0', 'pointer-events-none', 'translate-x-8'); 
                } else {
                    womanSvg.style.opacity = '1'; womanSvg.style.transform = 'scale(1)';
                    manSvg.style.opacity = '0'; manSvg.style.transform = 'scale(0.95)';
                    shapeLabel.textContent = 'X-Shape –ú–æ–¥–µ–ª—å';
                    shapeLabel.classList.remove('text-acc-purple'); shapeLabel.classList.add('text-acc-pink');
                    pfWoman.classList.remove('opacity-0', 'pointer-events-none', 'translate-x-8'); 
                    pfMan.classList.add('opacity-0', 'pointer-events-none', 'translate-x-8'); 
                }
            });
        });

        // ============================================================================
        // üå¨Ô∏è BREATH ENGINE (BUBBLE EDITION - FIXED)
        // ============================================================================
        
        const BREATH_CONFIG = {
            focus: { color: '#5e60ce', glow: 'rgba(94, 96, 206, 0.6)', inhale: 4000, exhale: 4000, hold: 4000, title: 'Square Breath' },
            sleep: { color: '#ff9f0a', glow: 'rgba(255, 159, 10, 0.6)', inhale: 4000, exhale: 8000, hold: 7000, title: '4-7-8 Relax' },
            stress: { color: '#4facfe', glow: 'rgba(79, 172, 254, 0.6)', inhaleBase: 3000, inhaleTop: 800, exhale: 6000, type: 'double_inhale', title: 'Physiological Sigh' }
        };

        let isBreathing = false;
        let activeConfig = null;
        
        const el = {
            bubble: document.getElementById('breath-bubble'),
            lbl: document.getElementById('breath-status-lbl'),
            title: document.getElementById('breath-title'),
            bg: document.getElementById('breath-bg')
        };

        function startBreath(key) {
            isBreathing = false; // Kill previous loop
            
            activeConfig = BREATH_CONFIG[key];
            el.title.innerText = activeConfig.title;
            el.title.style.color = activeConfig.color;
            el.lbl.style.color = activeConfig.color;
            el.lbl.classList.add('visible');
            
            el.bubble.style.background = `radial-gradient(circle, ${activeConfig.color} 0%, transparent 70%)`;
            el.bubble.style.boxShadow = `0 0 40px ${activeConfig.glow}`;
            el.bubble.style.setProperty('--breath-color', activeConfig.color);
            
            document.querySelectorAll('.breath-btn').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById('btn-' + key);
            if(btn) btn.classList.add('active');

            setTimeout(() => {
                isBreathing = true;
                if(activeConfig.type === 'double_inhale') runStressCycle();
                else if(key === 'sleep') runSleepCycle();
                else runFocusCycle();
            }, 50);
        }

        function scaleBubble(scale, duration) {
            return new Promise(resolve => {
                // FIXED: Use explicit transition property to avoid JS overriding
                el.bubble.style.transition = `transform ${duration}ms cubic-bezier(0.4, 0.0, 0.2, 1)`;
                el.bubble.style.transform = `scale(${scale})`;
                setTimeout(resolve, duration);
            });
        }

        async function runFocusCycle() {
            const { inhale, hold, exhale } = activeConfig;
            while(isBreathing && activeConfig.title === 'Square Breath') {
                setStatus('–í–î–û–•'); await scaleBubble(1.5, inhale); if(!isBreathing) break;
                setStatus('–ü–ê–£–ó–ê'); await scaleBubble(1.5, hold); if(!isBreathing) break;
                setStatus('–í–´–î–û–•'); await scaleBubble(1.0, exhale); if(!isBreathing) break;
                setStatus('–ü–ê–£–ó–ê'); await scaleBubble(1.0, hold); if(!isBreathing) break;
            }
        }

        async function runSleepCycle() {
            const { inhale, hold, exhale } = activeConfig;
            while(isBreathing && activeConfig.title === '4-7-8 Relax') {
                setStatus('–í–î–û–•'); await scaleBubble(1.6, inhale); if(!isBreathing) break;
                setStatus('–ó–ê–î–ï–†–ñ–ö–ê'); await scaleBubble(1.6, hold); if(!isBreathing) break;
                setStatus('–í–´–î–û–•'); await scaleBubble(1.0, exhale); if(!isBreathing) break;
            }
        }

        async function runStressCycle() {
            const { inhaleBase, inhaleTop, exhale } = activeConfig;
            while(isBreathing && activeConfig.type === 'double_inhale') {
                setStatus('–í–î–û–•'); await scaleBubble(1.4, inhaleBase); if(!isBreathing) break;
                setStatus('–ï–©–ï'); await scaleBubble(1.6, inhaleTop); if(!isBreathing) break;
                setStatus('–í–´–î–û–•'); await scaleBubble(1.0, exhale); if(!isBreathing) break;
            }
        }

        function setStatus(text) {
            el.lbl.style.opacity = 0;
            setTimeout(() => {
                el.lbl.textContent = text;
                el.lbl.style.opacity = 1;
            }, 200);
        }
    </script>
</body>
</html>