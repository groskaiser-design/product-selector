const a0_0xa7b32e=a0_0x8ef8;(function(_0x5db49a,_0x5349f2){const _0x519925=a0_0x8ef8,_0x63afd3=_0x5db49a();while(!![]){try{const _0x192fb2=-parseInt(_0x519925(0x103))/0x1+-parseInt(_0x519925(0x146))/0x2+parseInt(_0x519925(0x177))/0x3+-parseInt(_0x519925(0x17c))/0x4*(parseInt(_0x519925(0x16f))/0x5)+-parseInt(_0x519925(0x138))/0x6*(parseInt(_0x519925(0x166))/0x7)+-parseInt(_0x519925(0x17b))/0x8+-parseInt(_0x519925(0x124))/0x9*(-parseInt(_0x519925(0x10c))/0xa);if(_0x192fb2===_0x5349f2)break;else _0x63afd3['push'](_0x63afd3['shift']());}catch(_0x51c1d0){_0x63afd3['push'](_0x63afd3['shift']());}}}(a0_0x2f0c,0x688f2));const tg=window[a0_0xa7b32e(0x11f)]?.[a0_0xa7b32e(0x12d)],HOME_URL=a0_0xa7b32e(0x15f);function setupTelegramBackButton(){const _0x1b4fc0=a0_0xa7b32e;if(!tg)return;try{tg['ready'](),tg[_0x1b4fc0(0x121)](),tg[_0x1b4fc0(0x13c)]?.(_0x1b4fc0(0x10b));if(tg[_0x1b4fc0(0x16e)]?.(_0x1b4fc0(0x16d)))tg[_0x1b4fc0(0x160)]?.();const _0x283c8f=tg[_0x1b4fc0(0x127)];if(_0x283c8f){_0x283c8f[_0x1b4fc0(0x137)]();if(typeof _0x283c8f[_0x1b4fc0(0x134)]===_0x1b4fc0(0x165))try{_0x283c8f['offClick']();}catch(_0x46cd0b){}_0x283c8f[_0x1b4fc0(0x158)](()=>{const _0x348a81=_0x1b4fc0;if(tg[_0x348a81(0x184)])tg[_0x348a81(0x184)][_0x348a81(0x11e)](_0x348a81(0x17f));location[_0x348a81(0x13b)]=HOME_URL;});}}catch(_0x461ead){console[_0x1b4fc0(0x163)](_0x1b4fc0(0x12e),_0x461ead);}}(function initStableLayout(){const _0x3d52d9=a0_0xa7b32e,_0x289d1e=(function(){let _0x174b72=!![];return function(_0x2aabe5,_0x193dbb){const _0x5e2eb6=_0x174b72?function(){const _0x2c9396=a0_0x8ef8;if(_0x193dbb){const _0x2a571d=_0x193dbb[_0x2c9396(0x104)](_0x2aabe5,arguments);return _0x193dbb=null,_0x2a571d;}}:function(){};return _0x174b72=![],_0x5e2eb6;};}()),_0x3617cb=document['querySelector']('.container'),_0x2d30ae=document['getElementById'](_0x3d52d9(0x113)),_0x3a26ad=document[_0x3d52d9(0x117)](_0x3d52d9(0x10e)),_0x1eaad4=document[_0x3d52d9(0x117)](_0x3d52d9(0x10f));function _0x813aed(){const _0x320d83=_0x3d52d9,_0x2574f0=_0x289d1e(this,function(){const _0x46e94f=a0_0x8ef8;return _0x2574f0[_0x46e94f(0x17d)]()[_0x46e94f(0x11a)](_0x46e94f(0x16b))[_0x46e94f(0x17d)]()[_0x46e94f(0x169)](_0x2574f0)[_0x46e94f(0x11a)](_0x46e94f(0x16b));});_0x2574f0();if(!_0x3617cb)return;const _0x637092=tg&&tg[_0x320d83(0x119)]?tg[_0x320d83(0x119)]:window[_0x320d83(0x123)];_0x3617cb[_0x320d83(0x135)][_0x320d83(0x14c)]=_0x637092+'px';if(_0x2d30ae){const _0x42dbf3=_0x2d30ae['offsetHeight'];_0x3a26ad[_0x320d83(0x135)][_0x320d83(0x174)]=_0x42dbf3+0x28+'px';}}tg?tg['onEvent'](_0x3d52d9(0x111),({isStateStable:_0x540ece})=>{_0x813aed();if(_0x540ece)requestAnimationFrame(()=>{const _0x230e9a=a0_0x8ef8;_0x3a26ad[_0x230e9a(0x12b)]=_0x3a26ad[_0x230e9a(0x14e)];});}):window[_0x3d52d9(0x150)](_0x3d52d9(0x116),_0x813aed),_0x813aed(),_0x1eaad4&&(_0x1eaad4[_0x3d52d9(0x150)](_0x3d52d9(0x145),()=>{requestAnimationFrame(_0x813aed);}),_0x1eaad4[_0x3d52d9(0x150)](_0x3d52d9(0x152),()=>{setTimeout(()=>{const _0xcfad37=a0_0x8ef8;_0x3a26ad[_0xcfad37(0x12b)]=_0x3a26ad[_0xcfad37(0x14e)];},0x12c);}));}(),setupTelegramBackButton());const BACKEND_URL='https://script.google.com/macros/s/AKfycbzvlDKUH6qsON-A6iSHYvMU_6XWtReZc5oXnnZOMTgETfvZqMMh2zUbdQJF-iOanMBc/exec',REQUEST_TIMEOUT_MS=0xafc8;function a0_0x8ef8(_0x43a763,_0x499550){_0x43a763=_0x43a763-0x101;const _0x2e3561=a0_0x2f0c();let _0xfe7833=_0x2e3561[_0x43a763];return _0xfe7833;}let messages=[],isTyping=![];const chatArea=document[a0_0xa7b32e(0x117)](a0_0xa7b32e(0x10e)),emptyState=document[a0_0xa7b32e(0x117)](a0_0xa7b32e(0x142)),messageInput=document[a0_0xa7b32e(0x117)]('messageInput'),sendBtn=document[a0_0xa7b32e(0x117)](a0_0xa7b32e(0x164)),clearBtn=document[a0_0xa7b32e(0x117)]('clearBtn'),modal=document[a0_0xa7b32e(0x117)](a0_0xa7b32e(0x115)),mTitle=document[a0_0xa7b32e(0x117)](a0_0xa7b32e(0x16a)),mText=document[a0_0xa7b32e(0x117)]('modalText');let modalCallback=null;async function callBackend(_0x444d2d,_0x11a0a0){const _0x569848=a0_0xa7b32e,_0x490bcb=tg?.[_0x569848(0x151)]?.[_0x569848(0x167)]||{},_0x58916f=_0x490bcb['id']||localStorage[_0x569848(0x132)]('debug_uid')||'d-'+Math[_0x569848(0x180)](Math[_0x569848(0x15a)]()*0x3b9aca00);if(!_0x490bcb['id'])localStorage[_0x569848(0x11c)](_0x569848(0x172),_0x58916f);const _0xc982a3={'action':_0x444d2d,'user_id':_0x58916f,'user_data':{'first_name':_0x490bcb[_0x569848(0x108)],'username':_0x490bcb[_0x569848(0x101)]},'init_data':tg?.['initData']||'',..._0x11a0a0},_0x583bd6=new AbortController(),_0xd10daa=setTimeout(()=>_0x583bd6[_0x569848(0x168)](),REQUEST_TIMEOUT_MS);try{const _0x3bcfb8=await fetch(BACKEND_URL,{'method':_0x569848(0x122),'headers':{'Content-Type':_0x569848(0x173)},'body':JSON[_0x569848(0x143)](_0xc982a3),'signal':_0x583bd6[_0x569848(0x156)]});return clearTimeout(_0xd10daa),await _0x3bcfb8[_0x569848(0x141)]();}catch(_0x85a356){return{'success':![],'error':String(_0x85a356)};}}function formatTime(_0x2b3139){const _0x2d4415=a0_0xa7b32e,_0x4eadcc=new Date(_0x2b3139);return String(_0x4eadcc[_0x2d4415(0x178)]())[_0x2d4415(0x114)](0x2,'0')+':'+String(_0x4eadcc[_0x2d4415(0x13a)]())[_0x2d4415(0x114)](0x2,'0');}function createMessageElement(_0x7525cb,_0x27634d){const _0x33138d=a0_0xa7b32e,_0x8f3da7=document[_0x33138d(0x170)](_0x33138d(0x147));_0x8f3da7[_0x33138d(0x13e)]='message\x20'+_0x7525cb[_0x33138d(0x16c)];const _0x345768=document[_0x33138d(0x170)](_0x33138d(0x147));_0x345768[_0x33138d(0x13e)]='message-bubble',_0x345768[_0x33138d(0x109)]=_0x7525cb[_0x33138d(0x11b)][_0x33138d(0x14d)](/\n/g,_0x33138d(0x15b));const _0x22801a=document[_0x33138d(0x170)](_0x33138d(0x147));_0x22801a['className']=_0x33138d(0x176),_0x22801a['innerHTML']='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20width=\x2216\x22\x20height=\x2216\x22><path\x20d=\x22M3\x206h18M19\x206v14a2\x202\x200\x2001-2\x202H7a2\x202\x200\x2001-2-2V6m3\x200V4a2\x202\x200\x20012-2h4a2\x202\x200\x20012\x202v2M10\x2011v6M14\x2011v6\x22/></svg>',_0x22801a['onclick']=_0x37ff9c=>{_0x37ff9c['stopPropagation'](),confirmDelete(_0x27634d);};let _0x5094aa;_0x345768[_0x33138d(0x150)](_0x33138d(0x153),()=>_0x5094aa=setTimeout(()=>{const _0x573039=_0x33138d;_0x8f3da7[_0x573039(0x148)][_0x573039(0x179)](_0x573039(0x129));if(tg?.['HapticFeedback'])tg[_0x573039(0x184)][_0x573039(0x11e)]('medium');},0x1f4)),_0x345768[_0x33138d(0x150)](_0x33138d(0x13f),()=>clearTimeout(_0x5094aa));const _0x5cd585=document[_0x33138d(0x170)](_0x33138d(0x147));return _0x5cd585[_0x33138d(0x13e)]='message-time',_0x5cd585[_0x33138d(0x181)]=formatTime(_0x7525cb['timestamp']),_0x8f3da7[_0x33138d(0x107)](_0x22801a),_0x8f3da7[_0x33138d(0x107)](_0x345768),_0x8f3da7[_0x33138d(0x107)](_0x5cd585),_0x8f3da7;}function createTypingIndicator(){const _0x11dbba=a0_0xa7b32e,_0x795a4b=document['createElement'](_0x11dbba(0x147));return _0x795a4b[_0x11dbba(0x13e)]=_0x11dbba(0x12f),_0x795a4b['id']=_0x11dbba(0x185),_0x795a4b[_0x11dbba(0x109)]=_0x11dbba(0x17a),_0x795a4b;}function renderMessages(){const _0x5d947c=a0_0xa7b32e;Array[_0x5d947c(0x125)](chatArea['children'])[_0x5d947c(0x14a)](_0x40117f=>{const _0x5cfcd7=_0x5d947c;if(_0x40117f['id']!==_0x5cfcd7(0x142))_0x40117f[_0x5cfcd7(0x161)]();}),messages[_0x5d947c(0x183)]>0x0?(emptyState[_0x5d947c(0x135)][_0x5d947c(0x112)]=_0x5d947c(0x162),messages[_0x5d947c(0x14a)]((_0x8cb03a,_0x3c740b)=>chatArea[_0x5d947c(0x107)](createMessageElement(_0x8cb03a,_0x3c740b)))):emptyState[_0x5d947c(0x135)][_0x5d947c(0x112)]=_0x5d947c(0x140),requestAnimationFrame(()=>chatArea[_0x5d947c(0x12b)]=chatArea[_0x5d947c(0x14e)]);}function autoResizeTextarea(){const _0xc6726e=a0_0xa7b32e;messageInput['style'][_0xc6726e(0x14c)]=_0xc6726e(0x159),messageInput[_0xc6726e(0x135)]['height']=Math[_0xc6726e(0x118)](messageInput['scrollHeight'],0x78)+'px';}function updateSendButton(){const _0x137ae8=a0_0xa7b32e,_0xe6458c=messageInput[_0x137ae8(0x10d)][_0x137ae8(0x130)]();sendBtn[_0x137ae8(0x175)]=!_0xe6458c||isTyping;}async function sendMessage(){const _0x539e03=a0_0xa7b32e,_0x34ecbc=messageInput[_0x539e03(0x10d)][_0x539e03(0x130)]();if(!_0x34ecbc||isTyping)return;if(tg?.['HapticFeedback'])tg[_0x539e03(0x184)][_0x539e03(0x11e)](_0x539e03(0x17f));messages[_0x539e03(0x149)]({'role':_0x539e03(0x167),'content':_0x34ecbc,'timestamp':Date[_0x539e03(0x13d)]()}),localStorage[_0x539e03(0x11c)](_0x539e03(0x136),JSON[_0x539e03(0x143)](messages)),renderMessages(),messageInput[_0x539e03(0x10d)]='',autoResizeTextarea(),updateSendButton(),isTyping=!![],chatArea[_0x539e03(0x107)](createTypingIndicator()),chatArea[_0x539e03(0x12b)]=chatArea['scrollHeight'];const _0x555498=await callBackend(_0x539e03(0x128),{'message':_0x34ecbc});isTyping=![];const _0x47f673=document[_0x539e03(0x117)]('typingIndicator');if(_0x47f673)_0x47f673['remove']();let _0x313254=_0x539e03(0x11d);if(_0x555498['success']){_0x313254=_0x555498[_0x539e03(0x12a)]||_0x539e03(0x120);if(tg?.[_0x539e03(0x184)])tg['HapticFeedback'][_0x539e03(0x102)](_0x539e03(0x133));}else{_0x313254=_0x555498[_0x539e03(0x14b)]||_0x539e03(0x157);if(tg?.[_0x539e03(0x184)])tg[_0x539e03(0x184)][_0x539e03(0x102)]('error');}messages[_0x539e03(0x149)]({'role':'ai','content':_0x313254,'timestamp':Date[_0x539e03(0x13d)]()}),localStorage[_0x539e03(0x11c)](_0x539e03(0x136),JSON['stringify'](messages)),renderMessages();}function a0_0x2f0c(){const _0x1075f5=['touchend','flex','json','emptyState','stringify','contains','input','508926SjGHmx','div','classList','push','forEach','error','height','replace','scrollHeight','Enter','addEventListener','initDataUnsafe','focus','touchstart','onclick','parse','signal','Ошибка\x20сервера','onClick','auto','random','<br>','key','keydown','shiftKey','./router.html','disableVerticalSwipes','remove','none','warn','sendBtn','function','7KTADjN','user','abort','constructor','modalTitle','(((.+)+)+)+$','role','6.1','isVersionAtLeast','15CJopJG','createElement','splice','debug_uid','text/plain','paddingBottom','disabled','delete-btn','2299464asosQj','getHours','add','<div\x20class=\x22message-bubble\x22><div\x20class=\x22typing-indicator\x22><div\x20class=\x22typing-dot\x22></div><div\x20class=\x22typing-dot\x22></div><div\x20class=\x22typing-dot\x22></div></div></div>','684696nkzxTv','1085852ruuJIH','toString','modalCancel','light','floor','textContent','preventDefault','length','HapticFeedback','typingIndicator','username','notificationOccurred','493553TKyJNy','apply','Очистить\x20историю?','Начнется\x20новый\x20диалог.','appendChild','first_name','innerHTML','.message.show-delete','#050505','470epIbOE','value','chatArea','messageInput','target','viewportChanged','display','inputArea','padStart','confirmModal','resize','getElementById','min','viewportHeight','search','content','setItem','Ошибка\x20сети','impactOccurred','Telegram','Пустой\x20ответ','expand','POST','innerHeight','283653MTqDHB','from','removeItem','BackButton','send_message','show-delete','text','scrollTop','Действие\x20необратимо.','WebApp','TG\x20setup\x20error:','message\x20ai','trim','clear_history','getItem','success','offClick','style','ai_chat_messages','show','1029126KwvtYS','click','getMinutes','href','setHeaderColor','now','className'];a0_0x2f0c=function(){return _0x1075f5;};return a0_0x2f0c();}function confirmDelete(_0xcbc4ab){const _0x426942=a0_0xa7b32e;if(mTitle)mTitle[_0x426942(0x181)]='Удалить?';if(mText)mText[_0x426942(0x181)]=_0x426942(0x12c);modalCallback=()=>{const _0x22115d=_0x426942;messages[_0x22115d(0x171)](_0xcbc4ab,0x1),localStorage[_0x22115d(0x11c)](_0x22115d(0x136),JSON[_0x22115d(0x143)](messages)),renderMessages();},modal[_0x426942(0x148)]['add'](_0x426942(0x137));}if(clearBtn)clearBtn['onclick']=()=>{const _0x43b758=a0_0xa7b32e;if(!messages[_0x43b758(0x183)])return;if(mTitle)mTitle[_0x43b758(0x181)]=_0x43b758(0x105);if(mText)mText['textContent']=_0x43b758(0x106);modalCallback=async()=>{const _0x5ef405=_0x43b758;messages=[],localStorage[_0x5ef405(0x126)](_0x5ef405(0x136)),renderMessages(),callBackend(_0x5ef405(0x131),{});},modal[_0x43b758(0x148)][_0x43b758(0x179)](_0x43b758(0x137));};document['getElementById'](a0_0xa7b32e(0x17e))[a0_0xa7b32e(0x154)]=()=>modal[a0_0xa7b32e(0x148)]['remove'](a0_0xa7b32e(0x137)),document[a0_0xa7b32e(0x117)]('modalConfirm')[a0_0xa7b32e(0x154)]=()=>{const _0x5d5767=a0_0xa7b32e;if(modalCallback)modalCallback();modal[_0x5d5767(0x148)][_0x5d5767(0x161)]('show');},messageInput[a0_0xa7b32e(0x150)](a0_0xa7b32e(0x145),()=>{updateSendButton(),autoResizeTextarea();}),messageInput[a0_0xa7b32e(0x150)](a0_0xa7b32e(0x15d),_0x3c6acb=>{const _0x4371ac=a0_0xa7b32e;_0x3c6acb[_0x4371ac(0x15c)]===_0x4371ac(0x14f)&&!_0x3c6acb[_0x4371ac(0x15e)]&&(_0x3c6acb[_0x4371ac(0x182)](),sendMessage());}),sendBtn[a0_0xa7b32e(0x154)]=sendMessage,document['addEventListener'](a0_0xa7b32e(0x139),_0x20b590=>{const _0x4c76f1=a0_0xa7b32e;document['querySelectorAll'](_0x4c76f1(0x10a))[_0x4c76f1(0x14a)](_0x1f9704=>{const _0x5e67b9=_0x4c76f1;if(!_0x1f9704[_0x5e67b9(0x144)](_0x20b590[_0x5e67b9(0x110)]))_0x1f9704[_0x5e67b9(0x148)][_0x5e67b9(0x161)](_0x5e67b9(0x129));});});const saved=localStorage[a0_0xa7b32e(0x132)](a0_0xa7b32e(0x136));if(saved)try{messages=JSON[a0_0xa7b32e(0x155)](saved),renderMessages();}catch(a0_0x2f13bc){}updateSendButton();