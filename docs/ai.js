function a0_0x43ab(_0x96eaf3,_0x42a34f){_0x96eaf3=_0x96eaf3-0x81;const _0x548fb4=a0_0x3ede();let _0x324c62=_0x548fb4[_0x96eaf3];return _0x324c62;}const a0_0x2c3aac=a0_0x43ab;(function(_0x4f3da0,_0x539699){const _0x1794af=a0_0x43ab,_0x44c7fe=_0x4f3da0();while(!![]){try{const _0x580939=-parseInt(_0x1794af(0xfa))/0x1+parseInt(_0x1794af(0xc0))/0x2+-parseInt(_0x1794af(0xc4))/0x3*(parseInt(_0x1794af(0x90))/0x4)+-parseInt(_0x1794af(0xda))/0x5+-parseInt(_0x1794af(0xc7))/0x6+-parseInt(_0x1794af(0x9e))/0x7*(-parseInt(_0x1794af(0xfe))/0x8)+parseInt(_0x1794af(0xf6))/0x9;if(_0x580939===_0x539699)break;else _0x44c7fe['push'](_0x44c7fe['shift']());}catch(_0x407f37){_0x44c7fe['push'](_0x44c7fe['shift']());}}}(a0_0x3ede,0xc2fd6));const tg=window[a0_0x2c3aac(0xcf)]?.[a0_0x2c3aac(0xa4)],HOME_URL=a0_0x2c3aac(0xbc);function setupTelegramBackButton(){const _0x305ad8=a0_0x2c3aac,_0x34649f=(function(){let _0x1abdec=!![];return function(_0x2231a3,_0x3dea74){const _0x5dae5c=_0x1abdec?function(){const _0x11ab74=a0_0x43ab;if(_0x3dea74){const _0x722b5d=_0x3dea74[_0x11ab74(0xaf)](_0x2231a3,arguments);return _0x3dea74=null,_0x722b5d;}}:function(){};return _0x1abdec=![],_0x5dae5c;};}()),_0x4dcf54=_0x34649f(this,function(){const _0x47cfbe=a0_0x43ab;return _0x4dcf54['toString']()[_0x47cfbe(0xd0)]('(((.+)+)+)+$')[_0x47cfbe(0xf7)]()[_0x47cfbe(0xe5)](_0x4dcf54)[_0x47cfbe(0xd0)](_0x47cfbe(0xfb));});_0x4dcf54();if(!tg)return;try{tg['ready'](),tg['expand'](),tg['setHeaderColor']?.('#050505');if(tg['isVersionAtLeast']?.(_0x305ad8(0x81)))tg[_0x305ad8(0x101)]?.();const _0x4d67a7=tg[_0x305ad8(0xa8)];if(_0x4d67a7){_0x4d67a7[_0x305ad8(0xc1)]();if(typeof _0x4d67a7[_0x305ad8(0xf9)]==='function')try{_0x4d67a7[_0x305ad8(0xf9)]();}catch(_0x2ae3ef){}_0x4d67a7[_0x305ad8(0xe9)](()=>{const _0x1be72d=_0x305ad8;if(tg[_0x1be72d(0xcd)])tg[_0x1be72d(0xcd)][_0x1be72d(0xbb)](_0x1be72d(0xe1));location[_0x1be72d(0xc9)]=HOME_URL;});}}catch(_0xd2acf5){console['warn'](_0x305ad8(0xa7),_0xd2acf5);}}(function initStableLayout(){const _0x7fa924=a0_0x2c3aac,_0x22be39=document[_0x7fa924(0xde)]('.container'),_0x4c4686=document[_0x7fa924(0xe0)](_0x7fa924(0xd8)),_0x44c328=document[_0x7fa924(0xe0)](_0x7fa924(0xd9)),_0xa4ca7f=document[_0x7fa924(0xe0)](_0x7fa924(0xd7));function _0x42f71e(){const _0x2b3ad9=_0x7fa924;if(!_0x22be39)return;const _0x223141=tg&&tg['viewportHeight']?tg[_0x2b3ad9(0xad)]:window[_0x2b3ad9(0xdc)];_0x22be39['style'][_0x2b3ad9(0xf1)]=_0x223141+'px';if(_0x4c4686){const _0x562b78=_0x4c4686[_0x2b3ad9(0xf3)];_0x44c328[_0x2b3ad9(0x9a)][_0x2b3ad9(0xfc)]=_0x562b78+0x28+'px';}}tg?tg[_0x7fa924(0x8c)](_0x7fa924(0xb1),({isStateStable:_0x3f3105})=>{_0x42f71e();if(_0x3f3105)requestAnimationFrame(()=>{const _0x2cc587=a0_0x43ab;_0x44c328[_0x2cc587(0x87)]=_0x44c328['scrollHeight'];});}):window['addEventListener'](_0x7fa924(0xe6),_0x42f71e),_0x42f71e(),_0xa4ca7f&&(_0xa4ca7f[_0x7fa924(0xac)](_0x7fa924(0xdf),()=>{requestAnimationFrame(_0x42f71e);}),_0xa4ca7f['addEventListener']('focus',()=>{setTimeout(()=>{_0x44c328['scrollTop']=_0x44c328['scrollHeight'];},0x12c);}));}(),setupTelegramBackButton());const BACKEND_URL=a0_0x2c3aac(0xce),REQUEST_TIMEOUT_MS=0xafc8;let messages=[],isTyping=![];const chatArea=document['getElementById'](a0_0x2c3aac(0xd9)),emptyState=document[a0_0x2c3aac(0xe0)]('emptyState'),messageInput=document[a0_0x2c3aac(0xe0)]('messageInput'),sendBtn=document[a0_0x2c3aac(0xe0)](a0_0x2c3aac(0xe2)),clearBtn=document[a0_0x2c3aac(0xe0)]('clearBtn'),modal=document['getElementById'](a0_0x2c3aac(0x9c)),mTitle=document[a0_0x2c3aac(0xe0)]('modalTitle'),mText=document[a0_0x2c3aac(0xe0)](a0_0x2c3aac(0xae));let modalCallback=null;async function callBackend(_0x1baead,_0x4dc55b){const _0x29e51f=a0_0x2c3aac,_0x360461=tg?.['initDataUnsafe']?.[_0x29e51f(0xf2)]||{},_0x2a309a=_0x360461['id']||localStorage[_0x29e51f(0xe3)](_0x29e51f(0xf8))||'d-'+Math[_0x29e51f(0xea)](Math[_0x29e51f(0x93)]()*0x3b9aca00);if(!_0x360461['id'])localStorage[_0x29e51f(0x83)](_0x29e51f(0xf8),_0x2a309a);const _0x1412bb={'action':_0x1baead,'user_id':_0x2a309a,'user_data':{'first_name':_0x360461[_0x29e51f(0xed)],'username':_0x360461[_0x29e51f(0xca)]},'init_data':tg?.[_0x29e51f(0xd5)]||'',..._0x4dc55b},_0x2be087=new AbortController(),_0x5512cb=setTimeout(()=>_0x2be087[_0x29e51f(0x100)](),REQUEST_TIMEOUT_MS);try{const _0x5cb0e4=await fetch(BACKEND_URL,{'method':_0x29e51f(0xbe),'headers':{'Content-Type':_0x29e51f(0xaa)},'body':JSON[_0x29e51f(0xbf)](_0x1412bb),'signal':_0x2be087['signal']});return clearTimeout(_0x5512cb),await _0x5cb0e4[_0x29e51f(0xa6)]();}catch(_0x51f2d9){return{'success':![],'error':String(_0x51f2d9)};}}function formatTime(_0x5834b8){const _0x1d9098=a0_0x2c3aac,_0x39681f=new Date(_0x5834b8);return String(_0x39681f[_0x1d9098(0xdd)]())[_0x1d9098(0x96)](0x2,'0')+':'+String(_0x39681f[_0x1d9098(0xec)]())['padStart'](0x2,'0');}function createMessageElement(_0x3c8a6f,_0x48c55e){const _0x5ded51=a0_0x2c3aac,_0x1dc2ba=document[_0x5ded51(0xa3)](_0x5ded51(0x94));_0x1dc2ba[_0x5ded51(0xa1)]=_0x5ded51(0xb2)+_0x3c8a6f['role'];const _0x2faa75=document[_0x5ded51(0xa3)]('div');_0x2faa75[_0x5ded51(0xa1)]=_0x5ded51(0xe4),_0x2faa75[_0x5ded51(0x99)]=_0x3c8a6f[_0x5ded51(0xa9)][_0x5ded51(0xb8)](/\n/g,'<br>');const _0x1ef0e5=document['createElement']('div');_0x1ef0e5[_0x5ded51(0xa1)]=_0x5ded51(0x8b),_0x1ef0e5['innerHTML']=_0x5ded51(0xd1),_0x1ef0e5[_0x5ded51(0xbd)]=_0xf66d1b=>{const _0x3a036c=_0x5ded51;_0xf66d1b[_0x3a036c(0xeb)](),confirmDelete(_0x48c55e);};let _0x44901b;_0x2faa75[_0x5ded51(0xac)](_0x5ded51(0x91),()=>_0x44901b=setTimeout(()=>{const _0x181489=_0x5ded51;_0x1dc2ba[_0x181489(0x98)]['add'](_0x181489(0xb4));if(tg?.['HapticFeedback'])tg[_0x181489(0xcd)]['impactOccurred'](_0x181489(0xa0));},0x1f4)),_0x2faa75[_0x5ded51(0xac)](_0x5ded51(0xdb),()=>clearTimeout(_0x44901b));const _0x2456eb=document[_0x5ded51(0xa3)](_0x5ded51(0x94));return _0x2456eb[_0x5ded51(0xa1)]=_0x5ded51(0xb5),_0x2456eb[_0x5ded51(0xc3)]=formatTime(_0x3c8a6f[_0x5ded51(0x9f)]),_0x1dc2ba[_0x5ded51(0xf0)](_0x1ef0e5),_0x1dc2ba[_0x5ded51(0xf0)](_0x2faa75),_0x1dc2ba[_0x5ded51(0xf0)](_0x2456eb),_0x1dc2ba;}function createTypingIndicator(){const _0x5557e4=a0_0x2c3aac,_0x1d506e=document[_0x5557e4(0xa3)](_0x5557e4(0x94));return _0x1d506e[_0x5557e4(0xa1)]=_0x5557e4(0xd4),_0x1d506e['id']=_0x5557e4(0x8d),_0x1d506e['innerHTML']=_0x5557e4(0xee),_0x1d506e;}function renderMessages(){const _0x48a3cd=a0_0x2c3aac;Array[_0x48a3cd(0x97)](chatArea[_0x48a3cd(0x82)])[_0x48a3cd(0xa5)](_0x25d2e4=>{const _0x245e98=_0x48a3cd;if(_0x25d2e4['id']!==_0x245e98(0xf5))_0x25d2e4[_0x245e98(0xe7)]();}),messages[_0x48a3cd(0x8a)]>0x0?(emptyState[_0x48a3cd(0x9a)]['display']=_0x48a3cd(0xb9),messages[_0x48a3cd(0xa5)]((_0x3c02d7,_0x19e478)=>chatArea[_0x48a3cd(0xf0)](createMessageElement(_0x3c02d7,_0x19e478)))):emptyState[_0x48a3cd(0x9a)][_0x48a3cd(0xf4)]='flex',requestAnimationFrame(()=>chatArea[_0x48a3cd(0x87)]=chatArea[_0x48a3cd(0x9d)]);}function a0_0x3ede(){const _0x12b190=['remove','auto','onClick','floor','stopPropagation','getMinutes','first_name','<div\x20class=\x22message-bubble\x22><div\x20class=\x22typing-indicator\x22><div\x20class=\x22typing-dot\x22></div><div\x20class=\x22typing-dot\x22></div><div\x20class=\x22typing-dot\x22></div></div></div>','shiftKey','appendChild','height','user','offsetHeight','display','emptyState','25261704xKjiYK','toString','debug_uid','offClick','1368351OtIfWp','(((.+)+)+)+$','paddingBottom','Enter','32gHbzCX','modalConfirm','abort','disableVerticalSwipes','clear_history','6.1','children','setItem','parse','error','Ошибка\x20сети','scrollTop','Действие\x20необратимо.','value','length','delete-btn','onEvent','typingIndicator','disabled','now','19676LsPKcz','touchstart','contains','random','div','Пустой\x20ответ','padStart','from','classList','innerHTML','style','Ошибка\x20сервера','confirmModal','scrollHeight','1861370ujcpbP','timestamp','medium','className','keydown','createElement','WebApp','forEach','json','TG\x20setup\x20error:','BackButton','content','text/plain','.message.show-delete','addEventListener','viewportHeight','modalText','apply','Удалить?','viewportChanged','message\x20','target','show-delete','message-time','preventDefault','Начнется\x20новый\x20диалог.','replace','none','Очистить\x20историю?','impactOccurred','./router.html','onclick','POST','stringify','2812268weVFzG','show','success','textContent','129GrxgiN','push','trim','9506694WOYZVJ','add','href','username','removeItem','ai_chat_messages','HapticFeedback','https://script.google.com/macros/s/AKfycbzvlDKUH6qsON-A6iSHYvMU_6XWtReZc5oXnnZOMTgETfvZqMMh2zUbdQJF-iOanMBc/exec','Telegram','search','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20width=\x2216\x22\x20height=\x2216\x22><path\x20d=\x22M3\x206h18M19\x206v14a2\x202\x200\x2001-2\x202H7a2\x202\x200\x2001-2-2V6m3\x200V4a2\x202\x200\x20012-2h4a2\x202\x200\x20012\x202v2M10\x2011v6M14\x2011v6\x22/></svg>','querySelectorAll','notificationOccurred','message\x20ai','initData','min','messageInput','inputArea','chatArea','6568175eMUAGy','touchend','innerHeight','getHours','querySelector','input','getElementById','light','sendBtn','getItem','message-bubble','constructor','resize'];a0_0x3ede=function(){return _0x12b190;};return a0_0x3ede();}function autoResizeTextarea(){const _0x1caff6=a0_0x2c3aac;messageInput[_0x1caff6(0x9a)][_0x1caff6(0xf1)]=_0x1caff6(0xe8),messageInput[_0x1caff6(0x9a)][_0x1caff6(0xf1)]=Math[_0x1caff6(0xd6)](messageInput[_0x1caff6(0x9d)],0x78)+'px';}function updateSendButton(){const _0x52bf41=a0_0x2c3aac,_0x2c9dbd=messageInput[_0x52bf41(0x89)]['trim']();sendBtn[_0x52bf41(0x8e)]=!_0x2c9dbd||isTyping;}async function sendMessage(){const _0x4829c5=a0_0x2c3aac,_0x347972=messageInput[_0x4829c5(0x89)][_0x4829c5(0xc6)]();if(!_0x347972||isTyping)return;if(tg?.[_0x4829c5(0xcd)])tg['HapticFeedback'][_0x4829c5(0xbb)]('light');messages[_0x4829c5(0xc5)]({'role':'user','content':_0x347972,'timestamp':Date[_0x4829c5(0x8f)]()}),localStorage['setItem'](_0x4829c5(0xcc),JSON[_0x4829c5(0xbf)](messages)),renderMessages(),messageInput[_0x4829c5(0x89)]='',autoResizeTextarea(),updateSendButton(),isTyping=!![],chatArea['appendChild'](createTypingIndicator()),chatArea[_0x4829c5(0x87)]=chatArea['scrollHeight'];const _0x458f02=await callBackend('send_message',{'message':_0x347972});isTyping=![];const _0x14bb78=document['getElementById'](_0x4829c5(0x8d));if(_0x14bb78)_0x14bb78['remove']();let _0x570d4d=_0x4829c5(0x86);if(_0x458f02['success']){_0x570d4d=_0x458f02['text']||_0x4829c5(0x95);if(tg?.[_0x4829c5(0xcd)])tg[_0x4829c5(0xcd)][_0x4829c5(0xd3)](_0x4829c5(0xc2));}else{_0x570d4d=_0x458f02['error']||_0x4829c5(0x9b);if(tg?.[_0x4829c5(0xcd)])tg[_0x4829c5(0xcd)][_0x4829c5(0xd3)](_0x4829c5(0x85));}messages[_0x4829c5(0xc5)]({'role':'ai','content':_0x570d4d,'timestamp':Date['now']()}),localStorage[_0x4829c5(0x83)](_0x4829c5(0xcc),JSON[_0x4829c5(0xbf)](messages)),renderMessages();}function confirmDelete(_0x4f5e81){const _0x19882e=a0_0x2c3aac;if(mTitle)mTitle[_0x19882e(0xc3)]=_0x19882e(0xb0);if(mText)mText[_0x19882e(0xc3)]=_0x19882e(0x88);modalCallback=()=>{const _0x296bf3=_0x19882e;messages['splice'](_0x4f5e81,0x1),localStorage[_0x296bf3(0x83)](_0x296bf3(0xcc),JSON[_0x296bf3(0xbf)](messages)),renderMessages();},modal[_0x19882e(0x98)]['add'](_0x19882e(0xc1));}if(clearBtn)clearBtn[a0_0x2c3aac(0xbd)]=()=>{const _0x4be8b3=a0_0x2c3aac;if(!messages[_0x4be8b3(0x8a)])return;if(mTitle)mTitle[_0x4be8b3(0xc3)]=_0x4be8b3(0xba);if(mText)mText[_0x4be8b3(0xc3)]=_0x4be8b3(0xb7);modalCallback=async()=>{const _0x3e18b3=_0x4be8b3;messages=[],localStorage[_0x3e18b3(0xcb)](_0x3e18b3(0xcc)),renderMessages(),callBackend(_0x3e18b3(0x102),{});},modal[_0x4be8b3(0x98)][_0x4be8b3(0xc8)](_0x4be8b3(0xc1));};document[a0_0x2c3aac(0xe0)]('modalCancel')['onclick']=()=>modal['classList'][a0_0x2c3aac(0xe7)]('show'),document[a0_0x2c3aac(0xe0)](a0_0x2c3aac(0xff))['onclick']=()=>{const _0x4a9cd5=a0_0x2c3aac;if(modalCallback)modalCallback();modal[_0x4a9cd5(0x98)][_0x4a9cd5(0xe7)](_0x4a9cd5(0xc1));},messageInput[a0_0x2c3aac(0xac)]('input',()=>{updateSendButton(),autoResizeTextarea();}),messageInput[a0_0x2c3aac(0xac)](a0_0x2c3aac(0xa2),_0x2962e6=>{const _0x2bf658=a0_0x2c3aac;_0x2962e6['key']===_0x2bf658(0xfd)&&!_0x2962e6[_0x2bf658(0xef)]&&(_0x2962e6[_0x2bf658(0xb6)](),sendMessage());}),sendBtn[a0_0x2c3aac(0xbd)]=sendMessage,document[a0_0x2c3aac(0xac)]('click',_0x3d2003=>{const _0x3bf901=a0_0x2c3aac;document[_0x3bf901(0xd2)](_0x3bf901(0xab))['forEach'](_0x195333=>{const _0x31219b=_0x3bf901;if(!_0x195333[_0x31219b(0x92)](_0x3d2003[_0x31219b(0xb3)]))_0x195333[_0x31219b(0x98)]['remove'](_0x31219b(0xb4));});});const saved=localStorage[a0_0x2c3aac(0xe3)](a0_0x2c3aac(0xcc));if(saved)try{messages=JSON[a0_0x2c3aac(0x84)](saved),renderMessages();}catch(a0_0x213743){}updateSendButton();